var V=Object.defineProperty;var Z=(h,i,t)=>i in h?V(h,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[i]=t;var e=(h,i,t)=>Z(h,typeof i!="symbol"?i+"":i,t);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();class tt{constructor(){e(this,"successCount");e(this,"errorCount");e(this,"cache");e(this,"downloadQueue");this.successCount=0,this.errorCount=0,this.cache={},this.downloadQueue=[]}queueDownload(i){console.log("Queueing "+i),this.downloadQueue.push(i)}isDone(){return this.downloadQueue.length===this.successCount+this.errorCount}downloadAll(i){this.downloadQueue.length===0&&setTimeout(i,10);for(var t=0;t<this.downloadQueue.length;t++){var s=this,n=this.downloadQueue[t];console.log(n);var a=n.substring(n.length-3).toLowerCase();switch(a){case"jpg":case"png":var r=new Image;r.addEventListener("load",function(){console.log("Loaded "+this.src),s.successCount++,s.isDone()&&i()}),r.addEventListener("error",function(){console.log("Error loading "+this.src),s.errorCount++,s.isDone()&&i()}),r.src=n,this.cache[n]=r;break;case"wav":case"mp3":case"mp4":var d=new Audio;d.addEventListener("loadeddata",function(){console.log("Loaded "+this.src),s.successCount++,s.isDone()&&i()}),d.addEventListener("error",function(){console.log("Error loading "+this.src),s.errorCount++,s.isDone()&&i()}),d.addEventListener("ended",function(){d.pause(),d.currentTime=0}),d.src=n,d.load(),this.cache[n]=d;break}}}getAsset(i){return this.cache[i]}playAsset(i){let t=this.cache[i];if(!t){console.error(`Audio asset not found: ${i}`);return}if(t.loop){t.paused&&t.play().catch(n=>console.warn("Autoplay blocked:",n));return}let s=t.cloneNode();s.currentTime=0,s.volume=t.volume,s.play()}playBackgroundMusic(i){let t=this.cache[i];if(!t){console.error(`Background music not found: ${i}`);return}t.loop=!0,t.paused&&(t.currentTime=0,t.play().catch(s=>console.warn("Autoplay blocked:",s)))}muteAudio(i){for(var t in this.cache){let s=this.cache[t];s instanceof Audio&&(s.muted=i)}}adjustVolume(i){for(var t in this.cache){let s=this.cache[t];s instanceof Audio&&(s.volume=i)}}pauseBackgroundMusic(){for(var i in this.cache){let t=this.cache[i];t instanceof Audio&&(t.pause(),t.currentTime=0)}}autoRepeat(i){var t=this.cache[i];t.addEventListener("ended",function(){t.play()})}}class et{constructor(){e(this,"gameTime");e(this,"maxStep");e(this,"lastTimestamp");this.gameTime=0,this.maxStep=.05,this.lastTimestamp=0}tick(){const i=Date.now(),t=(i-this.lastTimestamp)/1e3;this.lastTimestamp=i;const s=Math.min(t,this.maxStep);return this.gameTime+=s,s}}class l{constructor(i,t="",s=!1){e(this,"game");e(this,"id","");e(this,"persistent",!1);e(this,"removeFromWorld",!1);e(this,"hidden",!1);e(this,"zIndex",0);if(this.constructor==l)throw new Error("Abstract classes can't be instantiated.");this.game=i,this.id=t,this.persistent=s,s&&i.registerPersistentGameObject(t,this)}init(){throw new Error("Method 'init()' must be implemented.")}loadSharedData(){const i=this.game.getSharedDataByKey(this.id);for(const t in i)this[t]=i[t]}update(){throw new Error("Method 'update()' must be implemented.")}draw(i){throw new Error("Method 'draw()' must be implemented.")}deload(){this.removeFromWorld=!0}restore(){this.removeFromWorld=!1}onMouseDown(i){}onMouseUp(i){}}class $ extends l{constructor(t,s){super(t);e(this,"game");e(this,"pot");e(this,"isOn");e(this,"gameWon");e(this,"gameOver");this.game=t,this.isOn=!1,this.pot=s,this.gameWon=!1,this.gameOver=!1}update(){if(this.isOn&&(this.pot.liters++,console.log(this.pot.liters)),!this.isOn&&this.pot.liters>0){if(this.pot.liters>=700&&this.pot.liters<800&&!this.gameWon){this.gameWon=!0,console.log(this.gameWon);const t=this.game.getSharedDataByKey("riceCooker"),s=t?t.amount+5:5;this.game.addSharedData("riceCooker",{amount:s}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3)}else this.gameWon=!1;this.gameOver=!0}}draw(t){this.isOn?t.drawImage(o.getAsset("./assets/objects/Faucet_On.png"),565,248):t.drawImage(o.getAsset("./assets/objects/Faucet_Off.png"),565,285),t.beginPath(),t.strokeStyle="red",t.rect(550,285,50,50),t.stroke()}faucetManager(t,s){t>=550&&t<=600&&s>=285&&s<=330&&!this.isOn?(this.isOn=!0,console.log(this.isOn)):t>=550&&t<=600&&s>=285&&s<=330&&this.isOn&&(this.isOn=!1,console.log(this.isOn))}}class st{constructor(i){e(this,"ctx");e(this,"entities");e(this,"persistentGameObjects");e(this,"click");e(this,"mouse");e(this,"move");e(this,"down");e(this,"previousMousePositionsDelay");e(this,"previousMousePositionsDelayCounter");e(this,"previousMousePositions");e(this,"previousMousePositionsLatest");e(this,"wheel");e(this,"keys");e(this,"options");e(this,"sceneManager");e(this,"currentScene");e(this,"hud");e(this,"sharedData");e(this,"timer");e(this,"running");e(this,"rightclick");e(this,"clockTick");e(this,"canvas",document.getElementById("gameWorld"));this.ctx=null,this.entities=[],this.persistentGameObjects={},this.click=null,this.mouse=null,this.down=null,this.previousMousePositionsDelay=3,this.previousMousePositionsDelayCounter=0,this.previousMousePositions=[],this.previousMousePositionsLatest=0,this.wheel=null,this.keys={},this.options=i||{debugging:!1},this.sceneManager=null,this.currentScene=null,this.hud=null,this.sharedData={}}init(i){this.ctx=i,this.startInput(),this.timer=new et}start(){this.running=!0;const i=()=>{this.loop(),requestAnimFrame(i,this.ctx.canvas)};i()}startInput(){var i=t=>{let s=this.ctx.canvas.getBoundingClientRect(),n=this.ctx.canvas.width/s.width,a=this.ctx.canvas.height/s.height,r=(t.clientX-s.left)*n,d=(t.clientY-s.top)*a;return{x:r,y:d}};this.ctx.canvas.addEventListener("mousemove",t=>{this.move=i(t),this.mouse=i(t),this.previousMousePositionsDelayCounter++,this.previousMousePositionsDelayCounter>=this.previousMousePositionsDelay&&(this.previousMousePositions.length>=15&&this.previousMousePositions.shift(),this.previousMousePositions.push(this.mouse),this.previousMousePositionsDelayCounter=0,this.previousMousePositionsLatest=this.timer.gameTime)}),this.ctx.canvas.addEventListener("mouseup",t=>{const s=i(t),n={...t,x:s.x,y:s.y};this.down=!1,this.entities.forEach(a=>{a.onMouseUp&&a.onMouseUp(n)})},!1),this.ctx.canvas.addEventListener("mousedown",t=>{const s=i(t),n={...t,x:s.x,y:s.y};this.down=!0,this.entities.forEach(a=>{a.onMouseDown&&a.onMouseDown(n)}),this.options.debugging&&this.addEntity(new it(this,n.x,n.y))},!1),this.ctx.canvas.addEventListener("click",t=>{this.entities.forEach(s=>{s instanceof $&&s.faucetManager(i(t).x,i(t).y)}),this.options.debugging&&(console.log("CLICK",i(t)),console.log(t)),this.click=i(t)}),this.ctx.canvas.addEventListener("wheel",t=>{this.options.debugging&&console.log("WHEEL",i(t),t.wheelDelta),t.preventDefault(),this.wheel=t}),this.ctx.canvas.addEventListener("contextmenu",t=>{this.options.debugging&&console.log("RIGHT_CLICK",i(t)),t.preventDefault(),this.rightclick=i(t)}),document.body.addEventListener("dndDrop",t=>{this.entities.forEach(s=>{s.onDnDDrop&&s.onDnDDrop(t)})},!1),this.ctx.canvas.addEventListener("keydown",t=>this.keys[t.key]=!0),this.ctx.canvas.addEventListener("keyup",t=>this.keys[t.key]=!1)}addEntity(i){this.entities.push(i)}draw(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.canvas.style.cursor="auto";for(let i=0;i<this.entities.length;i++)this.entities[i].draw(this.ctx,this)}update(){let i=this.entities.length;this.entities.sort((t,s)=>t.zIndex-s.zIndex);for(let t=0;t<i;t++){let s=this.entities[t];if(s.removeFromWorld||s.update(),i!==this.entities.length){let n=i-this.entities.length;i=this.entities.length,t-=n}}for(let t=this.entities.length-1;t>=0;--t)this.entities[t].removeFromWorld&&this.entities.splice(t,1)}loop(){this.clockTick=this.timer.tick(),this.update(),this.draw()}getSceneManager(){if(!this.sceneManager)throw new Error("SceneManager is not initialized");return this.sceneManager}getHUD(){if(!this.hud)throw new Error("HUD is not initialized");return this.hud}getSharedData(){return this.sharedData}getSharedDataByKey(i){return this.sharedData[i]}getSharedDataByKeyAndDefault(i,t){return this.sharedData[i]===void 0?t:this.sharedData[i]}addSharedData(i,t){this.sharedData[i]={...this.sharedData[i],...t}}removeSharedDataByKey(i){delete this.sharedData[i]}registerPersistentGameObject(i,t){this.persistentGameObjects[i]=t}getPersistentGameObject(i){return this.persistentGameObjects[i]}removePersistentGameObject(i){delete this.persistentGameObjects[i]}clearPersistentGameObjects(){this.persistentGameObjects={}}}class it extends l{constructor(t,s,n){super(t);e(this,"x");e(this,"y");this.x=s,this.y=n}update(){}draw(t){t.fillStyle="red",t.fillRect(this.x,this.y,5,5)}}let O=class extends l{constructor(t,s,n=0,a=0,r=0,d=0){super(t,"background");e(this,"game");e(this,"spritesheet");e(this,"x");e(this,"y");e(this,"width");e(this,"height");this.game=t,this.spritesheet=o.getAsset(s),this.x=n,this.y=a,r==0&&d==0?(this.width=this.spritesheet.width,this.height=this.spritesheet.height):(this.width=r,this.height=d)}update(){}draw(t){t.drawImage(this.spritesheet,this.x,this.y,this.width,this.height)}};class w extends l{constructor(t,s,n,a){super(t,"button");e(this,"image");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"bgColor");e(this,"text");e(this,"hidden");this.x=s,this.y=n,this.onClick=a,this.hidden=!1,this.zIndex=90}static imageButton(t,s,n,a,r){let d=new w(t,s,n,r);return Object.assign(d,{image:o.getAsset(a)}),d}static imageButtonWH(t,s,n,a,r,d,u){let g=new w(t,s,n,u);return Object.assign(g,{width:a,height:r,image:o.getAsset(d)}),g}static rectButton(t,s,n,a,r,d,u=""){let g=new w(t,s,n,d);return Object.assign(g,{width:a,height:r,bgColor:"gray",text:u}),g}static rectButtonImage(t,s,n,a,r,d,u){let g=new w(t,s,n,u);return Object.assign(g,{width:a,height:r,image:o.getAsset(d),transparent:!0}),g.draw=function(y){if(y.fillStyle="lightgrey",y.fillRect(this.x,this.y,this.width,this.height),this.image){const m=Math.min(this.width,this.height)*.8;y.drawImage(this.image,this.x+(this.width-m)/2,this.y+(this.height-m)/2,m,m)}else console.error(`Image not found for button: ${d}`)},g}update(){}onMouseDown(t){this.hidden||(this.image?t.x>this.x&&t.x<this.x+this.image.width&&t.y>this.y&&t.y<this.y+this.image.height&&this.onClick():t.x>this.x&&t.x<this.x+this.width&&t.y>this.y&&t.y<this.y+this.height&&this.onClick())}onClick(){throw new Error("Method not implemented.")}draw(t){this.hidden||(this.image&&this.width&&this.height?(this.game.mouse&&this.game.mouse.x>this.x&&this.game.mouse.x<this.x+this.width&&this.game.mouse.y>this.y&&this.game.mouse.y<this.y+this.height&&(this.game.canvas.style.cursor="pointer"),t.drawImage(this.image,this.x,this.y,this.width,this.height)):this.image?(this.game.mouse&&this.game.mouse.x>this.x&&this.game.mouse.x<this.x+this.image.width&&this.game.mouse.y>this.y&&this.game.mouse.y<this.y+this.image.height&&(this.game.canvas.style.cursor="pointer"),t.drawImage(this.image,this.x,this.y)):(this.game.mouse&&this.game.mouse.x>this.x&&this.game.mouse.x<this.x+this.width&&this.game.mouse.y>this.y&&this.game.mouse.y<this.y+this.height&&(this.game.canvas.style.cursor="pointer"),t.fillStyle=this.bgColor,t.fillRect(this.x,this.y,this.width,this.height),t.lineWidth=2,t.strokeStyle="black",t.strokeRect(this.x,this.y,this.width,this.height),t.fillStyle="black",t.font="36px serif",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.x+this.width/2,this.y+this.height/2+5)))}}class x extends l{constructor(t,s,n,a){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"onClick");e(this,"dragging");e(this,"transparent");e(this,"image");e(this,"bgColor");e(this,"width");e(this,"height");this.game=t,this.x=s,this.y=n,this.onClick=a,this.dragging=!1}static imageButton(t,s,n,a,r){let d=new x(t,s,n,r);return Object.assign(d,{image:o.getAsset(a)}),d}static transparentImageButton(t,s,n,a,r,d,u){let g=new x(t,s,n,u);return Object.assign(g,{width:a,height:r,image:o.getAsset(d),transparent:!0}),g}static rectButton(t,s,n,a,r,d,u){let g=new x(t,s,n,u);return Object.assign(g,{width:a,height:r,bgColor:d}),g}update(){}draw(t){this.game.options.debugging&&(t.strokeStyle="blue",t.strokeRect(this.x,this.y,this.width,this.height),this.image&&(t.strokeStyle="green")),!(this.transparent&&!this.dragging)&&(this.image?this.dragging?t.drawImage(this.image,this.game.mouse.x-this.image.width/2,this.game.mouse.y-this.image.height/2):t.drawImage(this.image,this.x,this.y):this.dragging?(t.fillStyle=this.bgColor||"gray",t.fillRect(this.game.mouse.x-this.width/2,this.game.mouse.y-this.height/2,this.width,this.height)):(t.fillStyle=this.bgColor||"gray",t.fillRect(this.x,this.y,this.width,this.height),t.lineWidth=2,t.strokeStyle="black",t.strokeRect(this.x,this.y,this.width,this.height)))}onMouseDown(t){this.image&&!this.transparent?t.x>this.x&&t.x<this.x+this.image.width&&t.y>this.y&&t.y<this.y+this.image.height&&(this.dragging=!0,this.onClick()):t.x>this.x&&t.x<this.x+this.width&&t.y>this.y&&t.y<this.y+this.height&&(this.dragging=!0,this.onClick())}onMouseUp(t){if(this.dragging){this.dragging=!1;const s=new CustomEvent("dndDrop",{detail:{x:t.x,y:t.y,button:this}});document.body.dispatchEvent(s)}}}class b{constructor(i){e(this,"game");e(this,"gameObjects");if(this.constructor==b)throw new Error("Abstract classes can't be instantiated.");this.game=i,this.gameObjects=[]}initalizeScene(){}addGameObject(i){this.gameObjects.push(i),this.game.addEntity(i)}addPersistantGameObject(i){let t=this.game.getPersistentGameObject(i);return t?(this.addGameObject(t),!0):!1}deload(){this.gameObjects.forEach(i=>{i.persistent||i.deload()}),this.gameObjects=[]}draw(i){}update(){}}const nt={money:0,gameTime:0,dayStartedAtTime:-1,orders:[],orderWorkingOn:null,currentDraggedItem:null,stationsComplete:{rice:!1,roll:!1,sides:!1}},B=class B{constructor(){e(this,"state",{...nt})}static getInstance(){return B.instance||(B.instance=new B),B.instance}setState(i,t){return this.state[i]=t,this.state[i]}getState(i){return this.state[i]}getAndMofifyState(i,t){const s=this.state[i],n=t(s);return this.state[i]=n,n}addOrder(i,t){this.state.orders.push({customer:i,order:t})}completeOrder(i){this.state.orders=this.state.orders.filter(t=>t.order!==i)}resetStationCompletion(i){for(const t in this.state.stationsComplete)this.state.stationsComplete[t]=!1;i.removeSharedDataByKey("bambooMat"),i.removeSharedDataByKey("foodBottom")}};e(B,"instance");let c=B;class ot extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"startButton");this.game=t,this.x=s,this.y=n}initalizeScene(){this.addGameObject(new O(this.game,"./assets/backgrounds/Title_Background.png")),this.startButton=w.imageButton(this.game,426,400,"./assets/button/Start_Button.png",()=>{if(o.playBackgroundMusic("./assets/sounds/background_music.mp3"),E.loadScene("order"),!this.game.timer)throw new Error("Timer is not initialized");c.getInstance().setState("dayStartedAtTime",this.game.timer.gameTime)}),this.addGameObject(this.startButton),this.game.getHUD().setState("hidden")}}class at extends l{constructor(t,s,n,a,r){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"progress");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.progress=.01}update(){if(this.progress>=1){this.game.win=!0;const t=this.game.getSharedDataByKey("riceCooker"),s=t?t.amount+5:5;this.game.addSharedData("riceCooker",{amount:s}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3);return}this.game.spinning&&this.progress<1&&(this.progress+=.001)}draw(t){t.fillStyle="green",t.fillRect(this.x,this.y,this.width*this.progress,this.height)}}const j=(h,i)=>Math.random()*(i-h)+h,ht=(h,i)=>Math.sqrt(Math.pow(i.x-h.x,2)+Math.pow(i.y-h.y,2));class rt extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=s,this.y=n}update(){if(this.game.timer.gameTime-this.game.previousMousePositionsLatest>.5&&(this.game.previousMousePositions=[],this.game.spinning=!1),this.game.previousMousePositions.length===15){let t=this.game.previousMousePositions.reduce((n,a)=>({x:n.x+a.x,y:n.y+a.y}),{x:0,y:0});if(t.x/=15,t.y/=15,ht(t,{x:this.x,y:this.y})>250){this.game.spinning=!1;return}let s=this.game.previousMousePositions.reduce((n,a)=>n+Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2)),0);s/=15,s<200?(console.log("spinning"),this.game.spinning=!0):this.game.spinning=!1}}draw(t){const s=o.getAsset("./assets/pot_top_outside.png");t.drawImage(s,this.x-s.width/2,this.y-s.height/2)}}class dt extends l{constructor(t,s,n,a){super(t);e(this,"game");e(this,"angle");e(this,"centerX");e(this,"centerY");e(this,"rotation");this.game=t,this.angle=s,this.centerX=n,this.centerY=a,this.rotation=j(0,Math.PI*2)}update(){this.game.spinning&&(this.angle+=Math.PI/180)}draw(t){const s=o.getAsset("./assets/objects/inside_rice.png"),n=o.getAsset("./assets/objects/middle_rice.png"),a=o.getAsset("./assets/objects/outside_rice.png");t.save(),t.translate(this.centerX,this.centerY),t.rotate(this.angle),t.drawImage(a,-a.width/2,-a.height/2),t.drawImage(n,-n.width/2,-n.height/2),t.drawImage(s,-s.width/2,-s.height/2),t.restore()}}class lt extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"angle");this.game=t,this.x=s,this.y=n,this.angle=Math.PI/3}update(){this.angle+=Math.PI/180}draw(t){const a=o.getAsset("./assets/rotate.png");t.save(),t.translate(1024/2,768/2),t.rotate(this.angle),t.drawImage(a,-450/2,-450/2,450,450),t.restore()}}class gt extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=s,this.y=n}update(){this.game.mouse&&(this.x=this.game.mouse.x,this.y=this.game.mouse.y)}draw(t){const a=o.getAsset("./assets/hand.png");t.drawImage(a,this.x-300/2,this.y-300/2,300,300)}}class ct extends l{constructor(t,s,n,a){super(t);e(this,"game");e(this,"ASSET_MANAGER");e(this,"x");e(this,"y");e(this,"start");e(this,"show");e(this,"timeShown");e(this,"timesFlashed");e(this,"audioPlayed");this.game=t,this.ASSET_MANAGER=s,this.x=n,this.y=a,this.start=!1,this.show=!1,this.timeShown=0,this.timesFlashed=0,this.audioPlayed=!1}update(){this.game.win&&(this.start=!0,this.audioPlayed||(this.ASSET_MANAGER.playAsset("./assets/sounds/jingle.mp3"),this.audioPlayed=!0)),this.start&&this.timesFlashed<6&&(this.timeShown++,this.timeShown>=20&&(this.show=!this.show,this.timeShown=0,this.timesFlashed++))}draw(t){this.show&&t.drawImage(o.getAsset("./assets/checkmark.png"),this.x-500/2,this.y-500/2,500,500)}}const q=1024,T=768;class ut extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.spritesheet=o.getAsset("./assets/backgrounds/Station_Background.png"),this.x=s,this.y=n}initalizeScene(){super.addGameObject(new mt(this.game,0,0)),super.addGameObject(new rt(this.game,q/2,T/2-20)),super.addGameObject(new at(this.game,0,T-20,1024,20)),super.addGameObject(new dt(this.game,0,q/2,T/2-20)),super.addGameObject(new lt(this.game,q/2,T/2-20)),super.addGameObject(new gt(this.game,0,0)),super.addGameObject(new ct(this.game,o,q/2,T/2))}}let mt=class extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=s,this.y=n,this.spritesheet=o.getAsset("./assets/backgrounds/Station_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};class U extends l{constructor(i,t){super(i),this.gameEngine=i,this.totalTime=t,this.elapsedTime=0,this.isCooking=!1,this.isDone=!1,this.result=null,this.perfectStart=this.totalTime*.8,this.perfectEnd=this.totalTime,this.x=237,this.y=650,this.width=550,this.height=20}start(){!this.isCooking&&!this.isDone&&(this.isCooking=!0,this.elapsedTime=0,this.result=null)}stop(){if(this.isCooking)if(this.isCooking=!1,this.isDone=!0,this.elapsedTime<this.perfectStart)this.result="undercooked";else if(this.elapsedTime>=this.perfectStart&&this.elapsedTime<=this.perfectEnd){this.result="perfect";const i=this.game.getSharedDataByKey("riceCooker"),t=i?i.amount+5:5;this.game.addSharedData("riceCooker",{amount:t}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3)}else this.result="overcooked"}update(){this.isCooking&&(this.elapsedTime+=this.gameEngine.clockTick,this.elapsedTime>=this.totalTime&&this.stop())}draw(i){i.fillStyle="lightgray",i.fillRect(this.x,this.y,this.width,this.height);const t=this.elapsedTime/this.totalTime*this.width;i.fillStyle="blue",i.fillRect(this.x,this.y,t,this.height);const s=this.x+this.perfectStart/this.totalTime*this.width,n=this.x+this.perfectEnd/this.totalTime*this.width;i.fillStyle="rgba(0, 255, 0, 0.3)",i.fillRect(s,this.y,n-s,this.height),this.isDone&&(i.fillStyle="black",i.font="16px Arial",i.fillText(`Result: ${this.result}`,this.x,this.y+this.height+20))}}let pt=class extends l{constructor(t){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"w");e(this,"h");this.game=t,this.x=237,this.y=100,this.w=550,this.h=525,this.clicked=!1}onMouseDown(t){this.isClicked(t.x,t.y)&&this.handleClick()}onMouseUp(t){this.isClicked(t.x,t.y)&&this.handleClick()}isClicked(t,s){return t>=this.x&&t<=this.x+this.w&&s>=this.y&&s<=this.y+this.h}handleClick(){const t=this.game.entities.find(s=>s instanceof U);t&&(this.clicked?(this.clicked=!1,t.stop()):(this.clicked=!0,t.start()))}update(){}draw(t){const s=o.getAsset("./assets/objects/RiceCooker_Off.png"),n=o.getAsset("./assets/objects/RiceCooker_On.png");t.drawImage(s,this.x,this.y,this.w,this.h),this.clicked&&(t.drawImage(n,this.x,this.y,this.w,this.h),t.strokeStyle="red",t.lineWidth=3,t.strokeRect(this.x,this.y,this.w,this.h))}};class wt extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=s,this.y=n}initalizeScene(){this.addGameObject(new ft(this.game,0,0));let t=new U(this.game,10),s=new pt(this.game);this.addGameObject(s),this.addGameObject(t)}}let ft=class extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=s,this.y=n,this.spritesheet=o.getAsset("./assets/backgrounds/Minigame_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};class yt extends l{constructor(t){super(t);e(this,"game");e(this,"liters");e(this,"spritesheet");e(this,"width");e(this,"height");e(this,"x");e(this,"y");this.game=t,this.liters=0,this.spritesheet=o.getAsset("./assets/objects/Pot_Animation.png"),this.width=380,this.height=300,this.x=322,this.y=386}update(){}draw(t){this.liters==0?t.drawImage(this.spritesheet,0,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=100?t.drawImage(this.spritesheet,380,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=200?t.drawImage(this.spritesheet,760,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=300?t.drawImage(this.spritesheet,1140,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=400?t.drawImage(this.spritesheet,1520,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=500?t.drawImage(this.spritesheet,1900,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=600?t.drawImage(this.spritesheet,2280,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=700?t.drawImage(this.spritesheet,2660,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=800?t.drawImage(this.spritesheet,3040,0,this.width,this.height,this.x,this.y,this.width,this.height):t.drawImage(this.spritesheet,3420,0,this.width,this.height,this.x,this.y,this.width,this.height)}}class bt extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=s,this.y=n}initalizeScene(){this.addGameObject(new St(this.game,0,0));const t=new yt(this.game);this.addGameObject(t),this.addGameObject(new $(this.game,t))}}let St=class extends l{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=s,this.y=n,this.spritesheet=o.getAsset("./assets/backgrounds/FillThePot_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};const _=class _{constructor(i,t,s){e(this,"id");e(this,"ingredients");e(this,"sides");e(this,"condiment");e(this,"completed");i.length===0&&t.length===0&&s===null?this.id=-1:this.id=_.idCounter++,this.ingredients=i,this.sides=t,this.condiment=s,this.completed=!1}};e(_,"idCounter",1);let A=_;class p{constructor(i,t=""){e(this,"name");e(this,"img");this.name=i,this.img=t}}class P{constructor(i,t){e(this,"name");e(this,"type");this.name=i,this.type=t}}class F{constructor(i){e(this,"type");this.type=i}}const W=new p("nori","./assets/objects/Nori.png"),K=new p("rice","./assets/objects/Rice.png"),kt="./assets/objects/Rice_Cooked.png",Dt=new p("avocado","./assets/assembly/avocado.png"),xt=new p("crab","./assets/assembly/crab.png"),Bt=new p("cucumber","./assets/assembly/cucumber.png"),Ot=new p("octopus","./assets/assembly/octopus.png"),It=new p("salmon","./assets/assembly/salmon.png"),Mt=new p("tuna","./assets/assembly/tuna.png"),Ct=new p("uni","./assets/assembly/uni.png"),vt=new p("tamago","./assets/assembly/tamago.png"),L=[W,K],Y=[Dt,xt,Bt,Ot,It,Mt,Ct,vt],At=new P("karaage",[new p("chicken")]),Tt=new P("miso soup",[new p("miso"),new p("green onion"),new p("tofu")]),jt=new P("edamame",[new p("edamame")]),Et=new P("gyoza",[new p("chicken"),new p("green onions")]),Gt=[At,Tt,jt,Et],qt=new F("wasabi"),Rt=new F("ginger"),_t=new F("soy sauce"),Pt=[qt,Rt,_t],D=200,I=360,M=40,H=8,C=(I-M)/H,v=C,N=v;function R(h,i,t,s){h.font="20px Arial",h.textAlign="center",h.fillStyle="white",h.fillRect(t,s,D,I),h.strokeStyle="black",h.fillStyle="#ff7f7f",i.id===-1?h.fillText("You made",t+D/2,s+25):h.fillText("#"+i.id,t+D/2,s+25),h.fillStyle="white";for(let d=2;d<H;d++)h.fillStyle=h.fillStyle==="#ffffff"?"#ff7f7f":"#ffffff",h.fillRect(t,s+d*C,D,C);h.fillStyle="#ff9999",h.fillRect(t,s+(I-M),D,M),h.strokeRect(t,s+(I-M),D,M),h.strokeRect(t,s,D,I);let n=s+C*(H-1);const a=t+D/2;h.fillStyle="black",i.ingredients.forEach(d=>{h.fillText(d.name,a+v,n+C/2),d.name==="rice"&&(h.fillStyle="gray",h.fillRect(a-v,n,v,N),h.fillStyle="black");const u=o.getAsset(d.img);h.drawImage(u,a-v,n,v,N),n-=C});let r=i.sides.length===0?"No sides":"Sides: ";i.sides.forEach(d=>{r+=d.name+", "}),i.sides.length>0&&(r=r.slice(0,-2)),h.fillStyle="black",h.textAlign="left",h.fillText(r,t+6,s+(I-M/2))}class z extends l{constructor(t,s,n){super(t,"customer",!0);e(this,"game");e(this,"x");e(this,"y");e(this,"yDrawOffset");e(this,"spritesheet");e(this,"exclamationSprite");e(this,"width");e(this,"height");e(this,"state");e(this,"order");e(this,"okButton");this.game=t,this.x=s,this.y=n,this.yDrawOffset=0,this.spritesheet=o.getAsset(this.randomCustomer()),this.exclamationSprite=o.getAsset("./assets/button/exclam.png"),this.width=400,this.height=600,this.state="init",this.order=null,this.addButton(),o.playAsset("./assets/sounds/doorchime.mp3"),console.log("Customer created")}update(){let t=this;switch(this.state){case"init":this.state="walking";async function s(){await t.walkTo(100,100),t.state="waitingToOrder"}s();break;case"walking":break;case"waitingToOrder":break;case"order":break;case"waitingToEat":break;case"leaving":this.state="walking";async function n(){await t.walkTo(-400,100),t.removeFromWorld=!0}n();break}}draw(t){switch(this.game.options.debugging&&(t.strokeStyle="red",t.strokeRect(this.x,this.y,this.width,this.height)),t.drawImage(this.spritesheet,this.x,this.y+this.yDrawOffset,this.width,this.height),this.state){case"init":break;case"walking":break;case"waitingToOrder":t.drawImage(this.exclamationSprite,this.x+this.spritesheet.width/2-this.exclamationSprite.width/2-10,this.y-30,100,100);break;case"order":this.drawOrder(t);break}}drawOrder(t){if(!this.order)return;R(t,this.order,500,100)}async walkTo(t,s){let n=this;return new Promise(a=>{let r=0;function d(){const g=Math.abs(n.x-t),y=Math.abs(n.y-s),m=t-n.x,f=s-n.y,S=Math.sqrt(m*m+f*f),k=m/S,G=f/S,J=Math.min(k*5,g),Q=Math.min(G*5,y);if(n.x!==t&&(n.x+=J),n.x!==t&&(n.y+=Q),n.x===t&&n.y===s){a(!0);return}n.yDrawOffset=Math.sin(Math.PI/4*r)*10,requestAnimationFrame(d),r+=.1}d()})}displayOrder(){this.order=this.randomOrder()}init(){this.game.currentScene&&this.okButton&&this.game.currentScene.addGameObject(this.okButton),this.state==="order"&&this.okButton&&(this.okButton.restore(),this.okButton.hidden=!1,console.log("make not hidden")),console.log(this.game.entities),console.log(this.okButton)}onOkButton(){this.okButton&&(console.log("OK button pressed"),console.log(this.okButton),this.okButton.hidden=!0,c.getInstance().addOrder(this,this.order),this.state="waitingToEat")}addButton(){if(console.log("Adding button"),!this.game.currentScene)throw new Error("No current scene found");this.okButton=w.rectButton(this.game,750,400,100,50,()=>this.onOkButton(),"OK"),this.okButton.hidden=!0,this.game.currentScene&&this.game.currentScene.addGameObject(this.okButton)}randomOrder(){function t(y,m){return y.slice().sort(()=>.5-Math.random()).slice(0,m)}const s=j(2,L.length),n=j(1,4),a=j(0,2),r=t(L,s),d=t(Y,n),u=t(Pt,1),g=t(Gt,a);return new A([...r,...d],[...g],u[0])}randomCustomer(){return"./assets/characters/Customer_"+(Math.floor(Math.random()*6)+0)+".png"}onMouseDown(t){this.state==="waitingToOrder"&&t.x>this.x&&t.x<this.x+this.width&&t.y>this.y&&t.y<this.y+this.height&&(this.displayOrder(),this.okButton.hidden=!1,this.state="order")}}class Wt extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=s,this.y=n}initalizeScene(){this.addGameObject(new O(this.game,"./assets/backgrounds/Order_Background.png")),this.addPersistantGameObject("customer")||(console.log("Did not find customer"),this.addGameObject(new z(this.game,500,25)));const t=new O(this.game,"./assets/backgrounds/Order_Foreground.png");t.zIndex=101,this.addGameObject(t);const s=this.game.getPersistentGameObject("customer");s.init();const n=c.getInstance().getState("orderWorkingOn");console.log(n),n&&n.completed&&(console.log("Adding rating handler"),this.addGameObject(new Ht(this.game,500,25,s)))}newCustomer(){console.log("New Customer");const t=new z(this.game,700,25);t.addButton(),this.addGameObject(t),c.getInstance().setState("orderWorkingOn",new A([],[],null)),c.getInstance().setState("orders",[])}deload(){super.deload();const t=this.game.getPersistentGameObject("customer");t.state==="order"&&(console.log("missed ok button"),t.onOkButton())}}class Ht extends l{constructor(t,s,n,a){super(t,"rating");e(this,"game");e(this,"x");e(this,"y");e(this,"rating");e(this,"customer");e(this,"state");this.game=t,this.x=s,this.y=n,this.rating=0,this.customer=a,this.state="judging",setTimeout(()=>{this.state="rating",this.rating=this.calculateRating(),console.log("Rating: "+this.rating)},2e3),setTimeout(()=>{this.state="done";let r=c.getInstance().getState("money");const d=j(6,11)*this.rating;c.getInstance().setState("money",r+d),console.log("Money to add: "+d,this.rating),this.game.addEntity(new Ft(this.game,this.customer.x+this.customer.spritesheet.width/2,this.customer.y)),this.customer.state="leaving",this.game.currentScene.newCustomer()},3e3)}update(){}draw(t){switch(t.font="72px Arial",t.fillStyle="black",t.textAlign="center",this.state){case"judging":t.fillText("...",this.customer.x+this.customer.spritesheet.width/2,this.customer.y+60),R(t,this.customer.order,500,100),R(t,c.getInstance().getState("orderWorkingOn"),750,100);break;case"rating":this.rating>=90?t.fillStyle="green":this.rating>=70?t.fillStyle="yellow":t.fillStyle="red",t.fillText("%"+(this.rating*100).toFixed(0),this.customer.x+this.customer.spritesheet.width/2,this.customer.y+60)}}calculateRating(){let t=c.getInstance().getState("orderWorkingOn"),s=this.customer.order;const n=.8,a=.2;let r=0,d=s.ingredients.length;s.ingredients.forEach((S,k)=>{t.ingredients[k]===S&&r++});let u=r/d||1;console.log("Ingredient Score: "+u);let g=0,y=s.sides.length;s.sides.forEach((S,k)=>{t.sides[k]===S&&g++});let m=g/y||1;console.log("Side Score: "+m);let f=u*n+m*a;return console.log("Total Score: "+f),f}}class Ft extends l{constructor(t,s,n){super(t,"moneyAdd",!0);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"sprite");this.game=t,this.x=s,this.y=n,this.width=50,this.height=50,this.sprite=o.getAsset("./assets/objects/coin_add.png"),this.zIndex=100,setTimeout(()=>{this.removeFromWorld=!0},3e3)}update(){this.y-=2}draw(t){t.drawImage(this.sprite,this.x,this.y,this.width,this.height)}}class Lt extends b{constructor(t){super(t);e(this,"game");this.game=t}initalizeScene(){super.addGameObject(new O(this.game,"./assets/backgrounds/Station_Background.png")),super.addGameObject(new $t(this.game,450,375));const t=new Nt(this.game,10,10,430,430);super.addGameObject(t);const s=new zt(this.game,500,80,450,300);super.addGameObject(s)}}class Nt extends l{constructor(t,s,n,a,r){super(t,"riceCooker");e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"amount");e(this,"cookerClicked");e(this,"spritesheet");e(this,"dnd");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.amount=1,this.cookerClicked=!1,this.spritesheet=o.getAsset("./assets/objects/RiceCooker.png"),this.addButton(),super.loadSharedData()}addButton(){this.dnd=x.transparentImageButton(this.game,this.x,this.y,this.width,this.height,kt,()=>{console.log("clicked on rice cooker"),this.cookerClicked=!0}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=K,this.dnd.id="ricesourcebuttons",this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){this.cookerClicked&&(this.amount==0&&(this.beginMinigame(),this.amount=5),this.amount--,this.cookerClicked=!1)}draw(t){t.drawImage(this.spritesheet,this.x,this.y),this.game.options.debugging&&(t.strokeStyle="red"),t.fillStyle="red",t.font="36px Arial",t.textAlign="center";let s=this.amount.toString();this.amount==0&&(s="Needs Refill!"),t.fillText(s,this.x+this.spritesheet.width/2,this.y+200)}beginMinigame(){const t=Math.floor(Math.random()*3);console.log(t),t==0?(this.game.getSceneManager().loadScene("fill"),console.log("minigame 1")):t==1?(this.game.getSceneManager().loadScene("burn"),console.log("minigame 2")):t==2&&(this.game.getSceneManager().loadScene("wash"),console.log("minigame 3"))}deload(){super.deload(),this.game.addSharedData("riceCooker",{amount:this.amount})}}class zt extends l{constructor(t,s,n,a,r){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"noriSourceSprite");e(this,"dnd");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.noriSourceSprite=o.getAsset("./assets/objects/Nori_Source.png"),this.addButton()}addButton(){this.dnd=x.transparentImageButton(this.game,this.x,this.y,this.width,this.height,W.img,()=>{}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=W,this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){}draw(t){t.drawImage(this.noriSourceSprite,this.x,this.y)}}class $t extends l{constructor(t,s,n){super(t,"bambooMat");e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");e(this,"sliding");e(this,"disabled");this.game=t,this.x=s,this.y=n,this.spritesheet=o.getAsset("./assets/objects/BambooMat.png"),this.sliding=!1,this.disabled=!1,super.loadSharedData()}update(){}draw(t){if(this.disabled)return;t.drawImage(this.spritesheet,this.x,this.y),this.x+this.spritesheet.width/2,this.y+this.spritesheet.height/2;const s=c.getInstance().getState("orderWorkingOn");if(s&&(s.ingredients.forEach(n=>{const a=o.getAsset(n.img);t.drawImage(a,this.x,this.y)}),!this.sliding&&s.ingredients.length==2)){setTimeout(()=>{let n=setInterval(()=>{this.x+=10,this.x>1024&&(this.removeFromWorld=!0,this.disabled=!0,this.game.addSharedData("bambooMat",{disabled:!0}),clearInterval(n))},10)},1e3),this.sliding=!0,this.game.addSharedData("bambooMat",{sliding:!0}),c.getInstance().getState("stationsComplete").rice=!0;return}}onDnDDrop(t){if(!(this.disabled||this.sliding)&&t.detail.x>=this.x&&t.detail.x<=this.x+this.spritesheet.width&&t.detail.y>=this.y&&t.detail.y<=this.y+this.spritesheet.height){console.log("dropped in food bottom");let s=c.getInstance().getState("orderWorkingOn");if(!s){let n=new A([],[],null);s=c.getInstance().setState("orderWorkingOn",n)}s.ingredients.push(t.detail.button.food)}}}class Ut extends b{constructor(t){super(t);e(this,"game");e(this,"foodBottom");e(this,"rollButton");this.game=t}initalizeScene(){this.addGameObject(new O(this.game,"./assets/backgrounds/Station_Background.png")),this.addGameObject(new O(this.game,"./assets/assembly/case.jpg",0,150,1024,197));const t=c.getInstance().getState("stationsComplete");t.rice&&!t.roll&&(this.foodBottom=new Xt(this.game,227,375,570,300),this.addGameObject(this.foodBottom));const s=80,n=80,a=Y;let r=0,d=240;for(let u=0;u<a.length;u++){const g=new Kt(this.game,a[r],10+u*(s+4),d,s,n);this.addGameObject(g),g.addButton(),r++}this.rollButton=w.imageButton(this.game,750,475,"./assets/button/Roll_Button2.png",()=>{console.log("Clicked roll button"),this.roll()}),this.rollButton.hidden=!0,this.addGameObject(this.rollButton)}roll(){console.log("rolling"),this.rollButton.removeFromWorld=!0,this.foodBottom.rolled=!0,this.game.addSharedData("foodBottom",{rolled:!0})}}class Kt extends l{constructor(t,s,n,a,r,d){super(t,"foodbin");e(this,"game");e(this,"food");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"dnd");this.game=t,this.food=s,this.x=n,this.y=a,this.width=r,this.height=d}addButton(){this.dnd=x.transparentImageButton(this.game,this.x,this.y,this.width,this.height,this.food.img,()=>{console.log("clicked on food bin",this.food)}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=this.food,this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){}draw(t){t.drawImage(o.getAsset("./assets/trays/tray_"+this.food.name+".png"),this.x,this.y,this.width,this.height);const s=80,n=35;this.width-s,this.height-n}}const Yt=75;class Xt extends l{constructor(t,s,n,a,r){super(t,"foodBottom");e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"rolled");e(this,"chops");e(this,"cut");e(this,"sliding");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.rolled=!1,this.chops=0,this.cut=!1,this.sliding=!1,this.rollx=0,super.loadSharedData()}update(){this.rolled&&(this.chops>=15&&(this.cut=!0,c.getInstance().getState("stationsComplete").roll=!0,console.log("Cut sushi")),this.game.down?(this.game.timer.gameTime-this.game.previousMousePositionsLatest>.1&&(this.game.previousMousePositions=[]),this.game.previousMousePositions.length===15&&this.game.previousMousePositions.forEach((t,s)=>{t.x>this.x-this.width/2&&t.x<this.x+this.width/2&&t.y>this.y&&t.y<this.y+Yt&&(this.chops+=1)})):this.game.previousMousePositions=[])}draw(t){let s=c.getInstance().getState("orderWorkingOn");if(s&&(s==null?void 0:s.ingredients.length)>0){if(this.cut){const a=o.getAsset("./assets/objects/Roll_Cut.png");if(t.drawImage(a,this.rollx,100),this.sliding)return;setTimeout(()=>{setInterval(()=>{this.rollx+=10,this.rollx>1024&&(this.removeFromWorld=!0)},10)},1e3),this.sliding=!0;return}if(this.rolled){const a=o.getAsset("./assets/objects/Roll.png");t.drawImage(a,0,100),this.game.down&&(t.beginPath(),this.game.previousMousePositions.forEach((r,d)=>{d===0?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y)}),t.stroke());return}const n=o.getAsset("./assets/objects/BambooMat.png");t.drawImage(n,this.x,this.y),s.ingredients.filter(a=>a.name==="rice"||a.name==="nori").forEach(a=>{if(a.name=="rice"||a.name=="nori"){const r=o.getAsset(a.img);t.drawImage(r,this.x,this.y)}}),s.ingredients.filter(a=>a.name!="rice"&&a.name!="nori").forEach(a=>{const r=o.getAsset(a.img),d=50,u=(this.width-d-130)/4;for(let g=0;g<4;g++)t.drawImage(r,this.x+g*u+d,this.y+75,r.width,r.height)})}}onDnDDrop(t){let s=c.getInstance().getState("orderWorkingOn");s&&t.detail.x>=this.x&&t.detail.x<=this.x+this.width&&t.detail.y>=this.y&&t.detail.y<=this.y+this.height&&(s==null?void 0:s.ingredients.length)>0&&(console.log("dropped in food bottom"),s.ingredients.push(t.detail.button.food),t.detail.button.game.currentScene.rollButton.hidden=!1)}}class Jt extends b{constructor(t,s,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"foodMessage");e(this,"microwave");e(this,"completeButton");this.game=t,this.x=s,this.y=n,this.foodMessage=null}initalizeScene(){this.addGameObject(new Qt(this.game)),c.getInstance().getState("stationsComplete").roll&&this.addGameObject(new Zt(this.game,225,325,175,100)),this.microwave=new Vt(this.game,200,0,600,300),this.addGameObject(this.microwave),this.microwave.addButtons(),[{name:"soy sauce",img:"./assets/sides/soysauce.png",x:800,y:300},{name:"ginger",img:"./assets/sides/Ginger.png",x:900,y:300},{name:"wasabi",img:"./assets/sides/wasabi.png",x:850,y:370}].forEach(n=>{this.addGameObject(new X(this.game,n,n.x,n.y,80,80))}),this.completeButton=w.rectButton(this.game,800,500,200,50,()=>{const n=c.getInstance().getState("orderWorkingOn");n.completed=!0,c.getInstance().resetStationCompletion(this.game),E.loadScene("order")},"Completed"),this.addGameObject(this.completeButton)}}class Qt extends l{constructor(t){super(t);e(this,"game");e(this,"sprite");this.game=t,this.sprite=o.getAsset("./assets/backgrounds/Station_Background.png")}update(){}draw(t){t.drawImage(this.sprite,0,0,1024,683)}}class Vt extends l{constructor(t,s,n,a,r){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"recipes");e(this,"cookButton");e(this,"ingredientButtons");e(this,"ingredients",[]);e(this,"microwaveSprite");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.recipes=[{name:"Miso Soup",ingredients:["Miso Paste","Tofu","Green Onions"],img:"./assets/sides/MisoSoup.png"},{name:"Edamame",ingredients:["Edamame"],img:"./assets/sides/cookedEdamame.png"},{name:"Gyoza",ingredients:["Green Onions","Chicken"],img:"./assets/sides/Gyoza.png"},{name:"Karaage",ingredients:["Chicken"],img:"./assets/sides/Karaage.png"}],this.cookButton=null,this.microwaveSprite=o.getAsset("./assets/sides/microwaveYuh.png")}addButtons(){let t=585,s=80;const n=80,a=100,r=65,d=2;this.ingredientButtons=[];const u=[{name:"Miso Paste",img:"./assets/sides/MisoBin.png"},{name:"Edamame",img:"./assets/sides/edamame.png"},{name:"Tofu",img:"./assets/sides/Tofu.png"},{name:"Green Onions",img:"./assets/sides/greenonions.png"},{name:"Chicken",img:"./assets/sides/chicken.png"}];for(let m=0;m<u.length;m++){let f=u[m],S=m%d,k=Math.floor(m/d);console.log(`Placing ${f.name} at col=${S}, row=${k}`);const G=w.rectButtonImage(this.game,t+S*a,s+k*r,n,n,f.img,()=>{console.log(`Clicked ${f.name}`),this.foodMessage=`${f.name} added!`,this.addIngredient(new p(f.name))});this.ingredientButtons.push(G),this.game.currentScene.addGameObject(G)}const g=687,y=220;this.cookButton=w.rectButton(this.game,g,y,75,75,()=>{this.cookSideDish()},"Cook!"),this.cookButton.disabled=!0,this.game.currentScene.addGameObject(this.cookButton)}addIngredient(t){if(!t||!t.name){console.error("invalid ingredient added!");return}this.ingredients.push(t),console.log(`added ${t.name} to microwave.`)}cookSideDish(){console.log("cooking!");const t=this.ingredients.map(s=>s.name);for(let s of this.recipes)if(s.ingredients.every(n=>t.includes(n))&&t.length===s.ingredients.length){console.log(`${s.name} created`),this.foodMessage=`${s.name} created!`,console.log(this.foodMessage),this.cookedSide=new X(this.game,{name:s.name,img:s.img},317,100,100,100),this.game.currentScene.addGameObject(this.cookedSide),this.ingredients=[];return}console.log("not matching recipe"),this.foodMessage="No matching recipe!",console.log(this.foodMessage),this.ingredients=[]}update(){this.cookButton&&(this.cookButton.disabled=this.ingredients.length===0)}draw(t){if(t.drawImage(this.microwaveSprite,this.x,this.y,this.width,this.height),this.cookedSide&&this.cookedSide.img){const s=o.getAsset(this.cookedSide.img);s?t.drawImage(s,317,100,100,100):console.warn(` no image for ${this.cookedSide.name}`)}this.foodMessage&&(t.fillStyle="white",t.font="20px Arial",t.textAlign="center",t.fillText(this.foodMessage,675,47))}}class Zt extends l{constructor(t,s,n,a,r){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"condiment");this.game=t,this.x=s,this.y=n,this.width=a,this.height=r,this.sideDishX=s,this.sideDishY=n,this.sideDishWidth=a,this.sideDishHeight=r,this.condiment=[]}update(){}draw(t){const s=o.getAsset("./assets/sides/Tray.png");t.drawImage(s,-125,-50,s.width+150,s.height+150),this.condiment.forEach(a=>{const r=o.getAsset(a.img);t.drawImage(r,this.x+45,this.y+15)}),t.save(),t.strokeStyle="red",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(this.sideDishX,this.sideDishY,this.sideDishWidth,this.sideDishHeight),t.restore();let n=c.getInstance().getState("orderWorkingOn");if(n&&(n==null?void 0:n.ingredients.length)>0){const a=o.getAsset("./assets/objects/Roll_Cut.png");t.drawImage(a,0,100)}}onDnDDrop(t){if(t.detail.x>this.sideDishX&&t.detail.x<this.sideDishX+this.sideDishWidth&&t.detail.y>this.sideDishY&&t.detail.y<this.sideDishY+this.sideDishHeight){console.log("dropped in food tray"),this.condiment.push(t.detail.button.food),console.log(t.detail.button.food);const s=c.getInstance().getState("orderWorkingOn");if(!s)return;s.ingredients.push(new p(t.detail.button.food.name))}}}class X extends l{constructor(t,s,n,a,r,d){super(t);e(this,"game");e(this,"food");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"dnd");this.game=t,this.food=s,this.x=n,this.y=a,this.width=r,this.height=d,this.addButton()}addButton(){this.dnd=x.transparentImageButton(this.game,this.x,this.y,this.width,this.height,this.food.img,()=>{console.log("clicked on object",this.food)}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=this.food,this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){}draw(t){t.drawImage(o.getAsset(this.food.img),this.x,this.y,this.width,this.height)}}class te extends b{constructor(t){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=0,this.y=0}initalizeScene(){this.addGameObject(new O(this.game,"./assets/backgrounds/Title_Background.png")),this.addGameObject(new ee(this.game))}}class ee extends l{constructor(t){super(t);e(this,"game");this.game=t}draw(t){const s=c.getInstance().getState("money");t.fillStyle="black",t.textAlign="center",t.font="30px Arial";const n=512,a=400;t.fillText("Game Over",n,a),t.fillText("Score: "+s,n,a+50),t.fillText("Thank you for playing!",n,a+100),t.fillText("Created by Christina Situ, Claire Nguyen, Melissa Harvey, & Quienten Miller",n,a+150)}}class se{constructor(i){e(this,"game");e(this,"scenes");e(this,"currentScene");e(this,"zIndex");this.game=i,this.scenes={},this.currentScene=null,this.zIndex=-1,this.registerScene("title",new ot(this.game,0,0)),this.registerScene("order",new Wt(this.game,0,0)),this.registerScene("rice",new Lt(this.game)),this.registerScene("roll",new Ut(this.game)),this.registerScene("sides",new Jt(this.game,0,0)),this.registerScene("burn",new wt(this.game,0,0)),this.registerScene("fill",new bt(this.game,0,0)),this.registerScene("wash",new ut(this.game,0,0)),this.registerScene("gameOver",new te(this.game)),this.loadScene("title")}registerScene(i,t){this.scenes[i]=t}loadScene(i){if(this.currentScene!==i){if(!this.scenes[i])throw new Error("Scene "+i+" not found");this.currentScene&&this.scenes[this.currentScene].deload(),this.currentScene=i,this.game.currentScene=this.scenes[i],this.game.getHUD().setState("main"),this.scenes[i].initalizeScene()}}update(){}draw(i){}}class ie extends l{constructor(t){super(t);e(this,"game");e(this,"state");e(this,"orderButton");e(this,"riceButton");e(this,"rollButton");e(this,"sidesButton");e(this,"trashButton");e(this,"orderDisplay");e(this,"coin_ui");this.game=t,this.state="main",this.orderButton=w.imageButton(t,102,694,"./assets/button/Order_Button.JPG",()=>this.loadSceneCallback("order")),this.riceButton=w.imageButton(t,318,694,"./assets/button/Rice_Button.JPG",()=>this.loadSceneCallback("rice")),this.rollButton=w.imageButton(t,534,694,"./assets/button/Roll_Button.JPG",()=>this.loadSceneCallback("roll")),this.sidesButton=w.imageButton(t,750,694,"./assets/button/Side_Button.JPG",()=>this.loadSceneCallback("sides")),this.trashButton=w.imageButtonWH(t,940,694,64,64,"./assets/button/trash.png",this.trashFood),t.addEntity(this.orderButton),t.addEntity(this.riceButton),t.addEntity(this.rollButton),t.addEntity(this.sidesButton),t.addEntity(this.trashButton),this.orderDisplay=new ne(t),t.addEntity(this.orderDisplay),this.coin_ui=o.getAsset("./assets/objects/coin_ui.png"),this.zIndex=100}loadSceneCallback(t){if(!this.game.sceneManager)throw new Error("SceneManager is not initialized");this.game.sceneManager.loadScene(t)}update(){switch(this.state){case"main":this.orderButton.hidden=!1,this.riceButton.hidden=!1,this.rollButton.hidden=!1,this.sidesButton.hidden=!1,this.trashButton.hidden=!1;break;case"hidden":this.orderButton.hidden=!0,this.riceButton.hidden=!0,this.rollButton.hidden=!0,this.sidesButton.hidden=!0,this.trashButton.hidden=!0;break;default:console.warn(`Unknown state: ${this.state}`);break}}drawMoney(t){t.drawImage(this.coin_ui,964,-6,64,64),t.fillStyle="yellow",t.font="24px Arial",t.textAlign="right",t.fillText(c.getInstance().getState("money").toFixed(2),964,36)}formatTime(){var r;if(!this.game.timer)return;const s=60*3-(this.game.timer.gameTime-c.getInstance().getState("dayStartedAtTime"));if(s<=0)return(r=this.game.sceneManager)==null||r.loadScene("gameOver"),"00:00";const n=Math.floor(s/60),a=Math.floor(s%60);return`${n.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}drawTimer(t){if(!this.game.timer)return;t.fillStyle="lightblue",t.font="24px Arial",t.textAlign="right";let s=this.formatTime();t.fillText("Timer: "+s,884,36)}draw(t){this.state!=="hidden"&&(this.drawMoney(t),this.drawTimer(t))}setState(t){this.state=t}trashFood(){console.log("trash food");let t=new A([],[],null);c.getInstance().setState("orderWorkingOn",t)}}class ne extends l{constructor(t){super(t,"orderDisplay",!0);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"state");this.game=t,this.x=0,this.y=0,this.width=1024,this.height=50,this.zIndex=100,this.state="collapsed"}pointInRect(t,s){return t>this.x&&t<this.x+this.width&&s>this.y&&s<this.y+this.height}update(){switch(this.game.getHUD().state){case"main":this.game.mouse&&this.pointInRect(this.game.mouse.x,this.game.mouse.y)?this.state="expanded":this.state="collapsed";break}}draw(t){switch(this.game.getHUD().state){case"main":this.game.options.debugging&&(t.fillStyle="black",t.fillRect(this.x,this.y,this.width,this.height)),t.globalAlpha=.5,t.fillStyle="gray",t.fillRect(this.x,this.y,this.width,this.height),t.globalAlpha=1;const s=c.getInstance().getState("orders");for(let n=0;n<s.length;n++){s[n].order;const a=this.x+10+210*n,r=this.y+10;t.fillStyle="white",t.fillRect(a,r,200,20),t.fillStyle="black",t.strokeRect(a,r,200,20)}if(this.state!=="expanded")return;for(let n=0;n<s.length;n++){const a=s[n].order;R(t,a,this.x+10+210*n,this.y+10)}break}}}const o=new tt;let E;o.queueDownload("./assets/backgrounds/Rice_Background.JPG");o.queueDownload("./assets/backgrounds/Roll_Background.JPG");o.queueDownload("./assets/backgrounds/Order_Background.png");o.queueDownload("./assets/backgrounds/Order_Foreground.png");o.queueDownload("./assets/backgrounds/Station_Background.png");o.queueDownload("./assets/backgrounds/Minigame_Background.png");o.queueDownload("./assets/backgrounds/Title_Background.png");o.queueDownload("./assets/objects/RiceCooker.png");o.queueDownload("./assets/objects/BambooMat.png");o.queueDownload("./assets/objects/Rice.png");o.queueDownload("./assets/objects/Rice_Cooked.png");o.queueDownload("./assets/objects/Nori.png");o.queueDownload("./assets/objects/Nori_Source.png");o.queueDownload("./assets/button/Rice_Button.JPG");o.queueDownload("./assets/button/Roll_Button.JPG");o.queueDownload("./assets/button/Roll_Button2.png");o.queueDownload("./assets/button/Side_Button.JPG");o.queueDownload("./assets/button/Order_Button.JPG");o.queueDownload("./assets/button/Start_Button.png");o.queueDownload("./assets/assembly/case.jpg");o.queueDownload("./assets/assembly/tray.jpg");o.queueDownload("./assets/objects/Roll.png");o.queueDownload("./assets/objects/Roll_Cut.png");o.queueDownload("./assets/hand.png");o.queueDownload("./assets/pot_top_outside.png");o.queueDownload("./assets/rotate.png");o.queueDownload("./assets/checkmark.png");o.queueDownload("./assets/objects/inside_rice.png");o.queueDownload("./assets/objects/middle_rice.png");o.queueDownload("./assets/objects/outside_rice.png");o.queueDownload("./assets/objects/Faucet_Off.png");o.queueDownload("./assets/objects/Faucet_On.png");o.queueDownload("./assets/objects/Pot_Animation.png");o.queueDownload("./assets/backgrounds/FillThePot_Background.png");o.queueDownload("./assets/objects/RiceCooker_On.png");o.queueDownload("./assets/objects/RiceCooker_Off.png");o.queueDownload("./assets/flies.png");o.queueDownload("./assets/swatter.png");o.queueDownload("./assets/characters/dummy.png");o.queueDownload("./assets/button/exclam.png");o.queueDownload("./assets/assembly/crab.png");o.queueDownload("./assets/assembly/cucumber.png");o.queueDownload("./assets/assembly/tuna.png");o.queueDownload("./assets/assembly/avocado.png");o.queueDownload("./assets/assembly/salmon.png");o.queueDownload("./assets/assembly/uni.png");o.queueDownload("./assets/assembly/tamago.png");o.queueDownload("./assets/assembly/octopus.png");o.queueDownload("./assets/characters/Customer_0.png");o.queueDownload("./assets/characters/Customer_1.png");o.queueDownload("./assets/characters/Customer_2.png");o.queueDownload("./assets/characters/Customer_3.png");o.queueDownload("./assets/characters/Customer_4.png");o.queueDownload("./assets/characters/Customer_5.png");o.queueDownload("./assets/trays/tray_avocado.png");o.queueDownload("./assets/trays/tray_crab.png");o.queueDownload("./assets/trays/tray_cucumber.png");o.queueDownload("./assets/trays/tray_octopus.png");o.queueDownload("./assets/trays/tray_salmon.png");o.queueDownload("./assets/trays/tray_tamago.png");o.queueDownload("./assets/trays/tray_tuna.png");o.queueDownload("./assets/trays/tray_uni.png");o.queueDownload("./assets/trays/tray_empty.png");o.queueDownload("./assets/sides/microwaveYuh.png");o.queueDownload("./assets/sides/Tofu.png");o.queueDownload("./assets/sides/MisoBin.png");o.queueDownload("./assets/sides/greenonions.png");o.queueDownload("./assets/sides/Ginger.png");o.queueDownload("./assets/sides/edamame.png");o.queueDownload("./assets/sides/Tray.png");o.queueDownload("./assets/sides/soysauce.png");o.queueDownload("./assets/sides/wasabi.png");o.queueDownload("./assets/sides/Gyoza.png");o.queueDownload("./assets/sides/MisoSoup.png");o.queueDownload("./assets/sides/Karaage.png");o.queueDownload("./assets/sides/chicken.png");o.queueDownload("./assets/sides/cookedEdamame.png");o.queueDownload("./assets/button/trash.png");o.queueDownload("./assets/sounds/jingle.mp3");o.queueDownload("./assets/sounds/doorchime.mp3");o.queueDownload("./assets/sounds/background_music.mp3");o.queueDownload("./assets/objects/coin_add.png");o.queueDownload("./assets/objects/coin_ui.png");o.downloadAll(()=>{const h=new st({debugging:!1}),i=document.getElementById("gameWorld");if(!i)throw new Error("Canvas element not found");const t=i.getContext("2d");if(!t)throw new Error("Canvas context not found");h.init(t);let s=new ie(h);h.addEntity(s),h.hud=s,E=new se(h),h.addEntity(E),h.sceneManager=E,h.start()});window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||((h,i)=>{window.setTimeout(h,1e3/60)});
//# sourceMappingURL=index-RQUUWlB2.js.map
