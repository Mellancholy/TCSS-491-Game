var L=Object.defineProperty;var F=(h,s,t)=>s in h?L(h,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[s]=t;var e=(h,s,t)=>F(h,typeof s!="symbol"?s+"":s,t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();class N{constructor(){e(this,"successCount");e(this,"errorCount");e(this,"cache");e(this,"downloadQueue");this.successCount=0,this.errorCount=0,this.cache={},this.downloadQueue=[]}queueDownload(s){console.log("Queueing "+s),this.downloadQueue.push(s)}isDone(){return this.downloadQueue.length===this.successCount+this.errorCount}downloadAll(s){this.downloadQueue.length===0&&setTimeout(s,10);for(var t=0;t<this.downloadQueue.length;t++){var i=this,n=this.downloadQueue[t];console.log(n);var o=n.substring(n.length-3).toLowerCase();switch(o){case"jpg":case"png":var r=new Image;r.addEventListener("load",function(){console.log("Loaded "+this.src),i.successCount++,i.isDone()&&s()}),r.addEventListener("error",function(){console.log("Error loading "+this.src),i.errorCount++,i.isDone()&&s()}),r.src=n,this.cache[n]=r;break;case"wav":case"mp3":case"mp4":var d=new Audio;d.addEventListener("loadeddata",function(){console.log("Loaded "+this.src),i.successCount++,i.isDone()&&s()}),d.addEventListener("error",function(){console.log("Error loading "+this.src),i.errorCount++,i.isDone()&&s()}),d.addEventListener("ended",function(){d.pause(),d.currentTime=0}),d.src=n,d.load(),this.cache[n]=d;break}}}getAsset(s){return this.cache[s]}playAsset(s){let t=this.cache[s];if(t.currentTime!=0){let i=t.cloneNode();i.currentTime=0,i.volume=t.volume,i.play()}else t.currentTime=0,t.play()}muteAudio(s){for(var t in this.cache){let i=this.cache[t];i instanceof Audio&&(i.muted=s)}}adjustVolume(s){for(var t in this.cache){let i=this.cache[t];i instanceof Audio&&(i.volume=s)}}pauseBackgroundMusic(){for(var s in this.cache){let t=this.cache[s];t instanceof Audio&&(t.pause(),t.currentTime=0)}}autoRepeat(s){var t=this.cache[s];t.addEventListener("ended",function(){t.play()})}}class X{constructor(){e(this,"gameTime");e(this,"maxStep");e(this,"lastTimestamp");this.gameTime=0,this.maxStep=.05,this.lastTimestamp=0}tick(){const s=Date.now(),t=(s-this.lastTimestamp)/1e3;this.lastTimestamp=s;const i=Math.min(t,this.maxStep);return this.gameTime+=i,i}}class c{constructor(s,t="",i=!1){e(this,"game");e(this,"id","");e(this,"persistent",!1);e(this,"removeFromWorld",!1);e(this,"hidden",!1);if(this.constructor==c)throw new Error("Abstract classes can't be instantiated.");this.game=s,this.id=t,this.persistent=i,i&&s.registerPersistentGameObject(t,this)}init(){throw new Error("Method 'init()' must be implemented.")}loadSharedData(){const s=this.game.getSharedDataByKey(this.id);for(const t in s)this[t]=s[t];this.game.removeSharedDataByKey(this.id)}update(){throw new Error("Method 'update()' must be implemented.")}draw(s){throw new Error("Method 'draw()' must be implemented.")}deload(){this.removeFromWorld=!0}restore(){this.removeFromWorld=!1}onMouseDown(s){}onMouseUp(s){}}class P extends c{constructor(t,i){super(t);e(this,"game");e(this,"pot");e(this,"isOn");e(this,"gameWon");e(this,"gameOver");this.game=t,this.isOn=!1,this.pot=i,this.gameWon=!1,this.gameOver=!1}update(){if(this.isOn&&(this.pot.liters++,console.log(this.pot.liters)),!this.isOn&&this.pot.liters>0){if(this.pot.liters>=700&&this.pot.liters<800&&!this.gameWon){this.gameWon=!0,console.log(this.gameWon);const t=this.game.getSharedDataByKey("riceCooker"),i=t?t.amount+5:5;this.game.addSharedData("riceCooker",{amount:i}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3)}else this.gameWon=!1;this.gameOver=!0}}draw(t){this.isOn?t.drawImage(a.getAsset("./assets/objects/Faucet_On.png"),565,248):t.drawImage(a.getAsset("./assets/objects/Faucet_Off.png"),565,285),t.beginPath(),t.strokeStyle="red",t.rect(550,285,50,50),t.stroke()}faucetManager(t,i){t>=550&&t<=600&&i>=285&&i<=330&&!this.isOn?(this.isOn=!0,console.log(this.isOn)):t>=550&&t<=600&&i>=285&&i<=330&&this.isOn&&(this.isOn=!1,console.log(this.isOn))}}class Y{constructor(s){e(this,"ctx");e(this,"entities");e(this,"persistentGameObjects");e(this,"click");e(this,"mouse");e(this,"move");e(this,"down");e(this,"previousMousePositionsDelay");e(this,"previousMousePositionsDelayCounter");e(this,"previousMousePositions");e(this,"previousMousePositionsLatest");e(this,"wheel");e(this,"keys");e(this,"currentDraggedItem");e(this,"options");e(this,"sceneManager");e(this,"currentScene");e(this,"sharedData");e(this,"timer");e(this,"running");e(this,"rightclick");e(this,"clockTick");this.ctx=null,this.entities=[],this.persistentGameObjects={},this.click=null,this.mouse=null,this.down=null,this.previousMousePositionsDelay=3,this.previousMousePositionsDelayCounter=0,this.previousMousePositions=[],this.previousMousePositionsLatest=0,this.wheel=null,this.keys={},this.currentDraggedItem=null,this.options=s||{debugging:!1},this.sceneManager=null,this.currentScene=null,this.sharedData={}}init(s){this.ctx=s,this.startInput(),this.timer=new X}start(){this.running=!0;const s=()=>{this.loop(),requestAnimFrame(s,this.ctx.canvas)};s()}startInput(){var s=t=>{var i=t.clientX-this.ctx.canvas.getBoundingClientRect().left,n=t.clientY-this.ctx.canvas.getBoundingClientRect().top;return{x:i,y:n}};this.ctx.canvas.addEventListener("mousemove",t=>{this.move=s(t),this.options.debugging&&console.log("MOUSE_MOVE",s(t)),this.mouse=s(t),this.previousMousePositionsDelayCounter++,this.previousMousePositionsDelayCounter>=this.previousMousePositionsDelay&&(this.previousMousePositions.length>=15&&this.previousMousePositions.shift(),this.previousMousePositions.push(this.mouse),this.previousMousePositionsDelayCounter=0,this.previousMousePositionsLatest=this.timer.gameTime)}),this.ctx.canvas.addEventListener("mouseup",t=>{this.down=!1,this.entities.forEach(i=>{i.onMouseUp&&i.onMouseUp(t)}),console.log("Mouse Up")},!1),this.ctx.canvas.addEventListener("mousedown",t=>{this.down=!0,this.entities.forEach(i=>{i.onMouseDown&&i.onMouseDown(t)})},!1),this.ctx.canvas.addEventListener("click",t=>{this.entities.forEach(i=>{i instanceof P&&i.faucetManager(s(t).x,s(t).y)}),this.options.debugging&&console.log("CLICK",s(t)),this.click=s(t)}),this.ctx.canvas.addEventListener("wheel",t=>{this.options.debugging&&console.log("WHEEL",s(t),t.wheelDelta),t.preventDefault(),this.wheel=t}),this.ctx.canvas.addEventListener("contextmenu",t=>{this.options.debugging&&console.log("RIGHT_CLICK",s(t)),t.preventDefault(),this.rightclick=s(t)}),document.body.addEventListener("dndDrop",t=>{this.entities.forEach(i=>{i.onDnDDrop&&i.onDnDDrop(t)})},!1),this.ctx.canvas.addEventListener("keydown",t=>this.keys[t.key]=!0),this.ctx.canvas.addEventListener("keyup",t=>this.keys[t.key]=!1)}addEntity(s){this.entities.push(s)}draw(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(let s=0;s<this.entities.length;s++)this.entities[s].draw(this.ctx,this)}update(){let s=this.entities.length;for(let t=0;t<s;t++){let i=this.entities[t];if(i.removeFromWorld||i.update(),s!==this.entities.length){let n=s-this.entities.length;s=this.entities.length,t-=n}}for(let t=this.entities.length-1;t>=0;--t)this.entities[t].removeFromWorld&&this.entities.splice(t,1)}loop(){this.clockTick=this.timer.tick(),this.update(),this.draw()}getSharedData(){return this.sharedData}getSharedDataByKey(s){return this.sharedData[s]}getSharedDataByKeyAndDefault(s,t){return this.sharedData[s]===void 0?t:this.sharedData[s]}addSharedData(s,t){this.sharedData[s]={...t}}removeSharedDataByKey(s){delete this.sharedData[s]}registerPersistentGameObject(s,t){this.persistentGameObjects[s]=t}getPersistentGameObject(s){return this.persistentGameObjects[s]}removePersistentGameObject(s){delete this.persistentGameObjects[s]}clearPersistentGameObjects(){this.persistentGameObjects={}}}class m extends c{constructor(t,i,n,o){super(t,"button");e(this,"image");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"bgColor");e(this,"text");Object.assign(this,{game:t,x:i,y:n,onClick:o,hidden:!1})}static imageButton(t,i,n,o,r){let d=new m(t,i,n,r);return Object.assign(d,{image:a.getAsset(o)}),d}static rectButton(t,i,n,o,r,d,l=""){let g=new m(t,i,n,d);return Object.assign(g,{width:o,height:r,bgColor:"gray",text:l}),g}update(){}onMouseDown(t){this.hidden||(this.image?t.offsetX>this.x&&t.offsetX<this.x+this.image.width&&t.offsetY>this.y&&t.offsetY<this.y+this.image.height&&this.onClick():t.offsetX>this.x&&t.offsetX<this.x+this.width&&t.offsetY>this.y&&t.offsetY<this.y+this.height&&this.onClick())}onClick(){throw new Error("Method not implemented.")}draw(t){this.hidden||(this.image?t.drawImage(this.image,this.x,this.y):(t.fillStyle=this.bgColor,t.fillRect(this.x,this.y,this.width,this.height),t.lineWidth=2,t.strokeStyle="black",t.strokeRect(this.x,this.y,this.width,this.height),t.fillStyle="black",t.font="36px serif",t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,this.x+this.width/2,this.y+this.height/2+5)))}}class b extends c{constructor(t,i,n,o){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"onClick");e(this,"dragging");e(this,"transparent");e(this,"image");e(this,"bgColor");e(this,"width");e(this,"height");this.game=t,this.x=i,this.y=n,this.onClick=o,this.dragging=!1}static imageButton(t,i,n,o,r){let d=new b(t,i,n,r);return Object.assign(d,{image:a.getAsset(o)}),d}static transparentImageButton(t,i,n,o,r,d,l){let g=new b(t,i,n,l);return Object.assign(g,{width:o,height:r,image:a.getAsset(d),transparent:!0}),g}static rectButton(t,i,n,o,r,d,l){let g=new b(t,i,n,l);return Object.assign(g,{width:o,height:r,bgColor:d}),g}update(){}draw(t){this.transparent&&!this.dragging||(this.image?this.dragging?t.drawImage(this.image,this.game.mouse.x-this.image.width/2,this.game.mouse.y-this.image.height/2):t.drawImage(this.image,this.x,this.y):this.dragging?(t.fillStyle=this.bgColor,t.fillRect(this.game.mouse.x-this.width/2,this.game.mouse.y-this.height/2,this.width,this.height)):(t.fillStyle=this.bgColor,t.fillRect(this.x,this.y,this.width,this.height),t.lineWidth=2,t.strokeStyle="black",t.strokeRect(this.x,this.y,this.width,this.height)))}onMouseDown(t){console.log("mouse down dnd button"),this.image&&!this.transparent?t.offsetX>this.x&&t.offsetX<this.x+this.image.width&&t.offsetY>this.y&&t.offsetY<this.y+this.image.height&&(this.dragging=!0,this.onClick()):t.offsetX>this.x&&t.offsetX<this.x+this.width&&t.offsetY>this.y&&t.offsetY<this.y+this.height&&(this.dragging=!0,this.onClick())}onMouseUp(t){if(this.dragging){this.dragging=!1;const i=new CustomEvent("dndDrop",{detail:{x:t.offsetX,y:t.offsetY,button:this}});document.body.dispatchEvent(i)}}}class J{constructor(s){e(this,"game");e(this,"activeOrders");e(this,"orderButton");e(this,"showOrder");this.game=s,this.activeOrders=[],this.showOrder=!1,this.addButton()}addOrder(s){this.activeOrders.push(s)}removeOrder(s){this.activeOrders=this.activeOrders.filter(t=>t!==s)}getOrders(){return this.activeOrders}getOrderLength(){return this.activeOrders.length}addButton(){this.orderButton=m.rectButton(this.game,150,0,200,50,()=>{this.showOrder=!this.showOrder,console.log(this.showOrder),console.log(this.activeOrders.length)},"ORDERS"),this.orderButton.persistent=!0,this.orderButton.hidden=!1,this.game.addEntity(this.orderButton)}update(){}draw(s){if(this.showOrder&&this.activeOrders.length>0){console.log("draw method");const t=8*40;s.fillStyle="white",s.fillRect(150,50,200,t),s.fillStyle="black",s.strokeRect(150,50,200,t),s.font="20px Arial",s.textAlign="center";const i=this.activeOrders[0],n=t+95;for(let o=0;o<i.ingredients.length+i.sides.length;o++){let r=n-o*30;if(o<i.ingredients.length)if(i.ingredients[o].type==="rice"||i.ingredients[o].type==="nori")s.fillText(i.ingredients[o].type,150,r);else{const d=a.getAsset(i.ingredients[o].img);s.drawImage(d,150-d.width/2,r-d.height)}else i.sides.length>0&&s.fillText(i.sides[o-i.ingredients.length].type,150,r)}}}}class K extends c{constructor(t,i,n,o,r){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"progress");this.game=t,this.x=i,this.y=n,this.width=o,this.height=r,this.progress=.01}update(){if(this.progress>=1){this.game.win=!0;const t=this.game.addSharedData("riceCooker"),i=t?t.amount+5:5;this.game.addSharedData("riceCooker",{amount:i}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3);return}this.game.spinning&&this.progress<1&&(this.progress+=.001)}draw(t){t.fillStyle="green",t.fillRect(this.x,this.y,this.width*this.progress,this.height)}}const M=(h,s)=>Math.random()*(s-h)+h,z=(h,s)=>Math.sqrt(Math.pow(s.x-h.x,2)+Math.pow(s.y-h.y,2));class U extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}update(){if(this.game.timer.gameTime-this.game.previousMousePositionsLatest>.5&&(this.game.previousMousePositions=[],this.game.spinning=!1),this.game.previousMousePositions.length===15){let t=this.game.previousMousePositions.reduce((n,o)=>({x:n.x+o.x,y:n.y+o.y}),{x:0,y:0});if(t.x/=15,t.y/=15,z(t,{x:this.x,y:this.y})>250){this.game.spinning=!1;return}let i=this.game.previousMousePositions.reduce((n,o)=>n+Math.sqrt(Math.pow(o.x-t.x,2)+Math.pow(o.y-t.y,2)),0);i/=15,i<200?(console.log("spinning"),this.game.spinning=!0):this.game.spinning=!1}}draw(t){const o=a.getAsset("./assets/pot_top.png");t.drawImage(o,this.x-750/2,this.y-750/2,750,750)}}class Q extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}update(){}draw(t){const o=a.getAsset("./assets/pot_top_outside.png");t.drawImage(o,this.x-750/2,this.y-750/2,750,750)}}const j=["#f5f5f5","#f8f8f8","#fafafa","#fcfcfc","#ffffff","#fefefe","#fdfdfd","#fbfbfb","#f7f7f7","#f4f4f4"];class $ extends c{constructor(t,i,n,o,r){super(t);e(this,"game");e(this,"angle");e(this,"distance");e(this,"centerX");e(this,"centerY");e(this,"x");e(this,"y");e(this,"rotation");e(this,"color");this.game=t,this.angle=i,this.distance=n,this.centerX=o,this.centerY=r,this.x=0,this.y=0,this.rotation=M(0,Math.PI*2),this.color=j[Math.floor(Math.random()*j.length)]}update(){this.game.spinning&&(this.angle+=Math.PI/180),this.x=this.distance*Math.cos(this.angle)+this.centerX,this.y=this.distance*Math.sin(this.angle)+this.centerY}draw(t){t.strokeStyle="black",t.fillStyle=this.color,t.beginPath(),t.ellipse(this.x,this.y,20,4,this.rotation,0,2*Math.PI),t.stroke(),t.fill()}}class V extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"angle");this.game=t,this.x=i,this.y=n,this.angle=Math.PI/3}update(){this.angle+=Math.PI/180}draw(t){const o=a.getAsset("./assets/rotate.png");t.save(),t.translate(1024/2,768/2),t.rotate(this.angle),t.drawImage(o,-450/2,-450/2,450,450),t.restore()}}class Z extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}update(){this.game.mouse&&(this.x=this.game.mouse.x,this.y=this.game.mouse.y)}draw(t){const o=a.getAsset("./assets/hand.png");t.drawImage(o,this.x-300/2,this.y-300/2,300,300)}}class tt extends c{constructor(t,i,n,o){super(t);e(this,"game");e(this,"ASSET_MANAGER");e(this,"x");e(this,"y");e(this,"start");e(this,"show");e(this,"timeShown");e(this,"timesFlashed");e(this,"audioPlayed");this.game=t,this.ASSET_MANAGER=i,this.x=n,this.y=o,this.start=!1,this.show=!1,this.timeShown=0,this.timesFlashed=0,this.audioPlayed=!1}update(){this.game.win&&(this.start=!0,this.audioPlayed||(this.ASSET_MANAGER.playAsset("./assets/sounds/jingle.mp3"),this.audioPlayed=!0)),this.start&&this.timesFlashed<6&&(this.timeShown++,this.timeShown>=20&&(this.show=!this.show,this.timeShown=0,this.timesFlashed++))}draw(t){this.show&&t.drawImage(a.getAsset("./assets/checkmark.png"),this.x-500/2,this.y-500/2,500,500)}}class y{constructor(s){e(this,"game");e(this,"gameObjects");if(this.constructor==y)throw new Error("Abstract classes can't be instantiated.");this.game=s,this.gameObjects=[]}initalizeScene(){}addGameObject(s){console.log(this),this.gameObjects.push(s),this.game.addEntity(s)}addPersistantGameObject(s){let t=this.game.getPersistentGameObject(s);return t?(this.addGameObject(t),!0):!1}deload(){this.gameObjects.forEach(s=>{s.persistent||s.deload()}),this.gameObjects=[]}draw(s){}update(){}}const v=1024,k=768,et=250;class A extends y{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.spritesheet=a.getAsset("./assets/backgrounds/Station_Background.png"),this.x=i,this.y=n}initalizeScene(){super.addGameObject(new st(this.game,0,0)),super.addGameObject(new K(this.game,0,k-20,1024,20)),super.addGameObject(new U(this.game,v/2,k/2));let t=2;for(let i=0;i<et;i+=20){for(let n=0;n<Math.PI*2;n+=Math.PI*2/t){let o=new $(this.game,n,i,v/2,k/2);super.addGameObject(o)}t+=10}super.addGameObject(new Q(this.game,v/2,k/2)),super.addGameObject(new V(this.game,v/2,k/2)),super.addGameObject(new Z(this.game,0,0)),super.addGameObject(new tt(this.game,a,v/2,k/2))}}let st=class extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=i,this.y=n,this.spritesheet=a.getAsset("./assets/backgrounds/Station_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};class R extends c{constructor(s,t){super(s),this.gameEngine=s,this.totalTime=t,this.elapsedTime=0,this.isCooking=!1,this.isDone=!1,this.result=null,this.perfectStart=this.totalTime*.8,this.perfectEnd=this.totalTime,this.x=237,this.y=650,this.width=550,this.height=20}start(){!this.isCooking&&!this.isDone&&(this.isCooking=!0,this.elapsedTime=0,this.result=null)}stop(){if(this.isCooking)if(this.isCooking=!1,this.isDone=!0,this.elapsedTime<this.perfectStart)this.result="undercooked";else if(this.elapsedTime>=this.perfectStart&&this.elapsedTime<=this.perfectEnd){this.result="perfect";const s=this.game.addSharedData("riceCooker"),t=s?s.amount+5:5;this.game.addSharedData("riceCooker",{amount:t}),setTimeout(()=>{this.game.sceneManager.loadScene("rice")},2e3)}else this.result="overcooked"}update(){this.isCooking&&(this.elapsedTime+=this.gameEngine.clockTick,this.elapsedTime>=this.totalTime&&this.stop())}draw(s){s.fillStyle="lightgray",s.fillRect(this.x,this.y,this.width,this.height);const t=this.elapsedTime/this.totalTime*this.width;s.fillStyle="blue",s.fillRect(this.x,this.y,t,this.height);const i=this.x+this.perfectStart/this.totalTime*this.width,n=this.x+this.perfectEnd/this.totalTime*this.width;s.fillStyle="rgba(0, 255, 0, 0.3)",s.fillRect(i,this.y,n-i,this.height),this.isDone&&(s.fillStyle="black",s.font="16px Arial",s.fillText(`Result: ${this.result}`,this.x,this.y+this.height+20))}}let it=class extends c{constructor(t){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"w");e(this,"h");this.game=t,this.x=237,this.y=100,this.w=550,this.h=525,this.clicked=!1}onMouseDown(t){this.isClicked(t.clientX,t.clientY)&&this.handleClick()}onMouseUp(t){this.isClicked(t.clientX,t.clientY)&&this.handleClick()}isClicked(t,i){return t>=this.x&&t<=this.x+this.w&&i>=this.y&&i<=this.y+this.h}handleClick(){const t=this.game.entities.find(i=>i instanceof R);t&&(this.clicked?(this.clicked=!1,t.stop()):(this.clicked=!0,t.start()))}update(){}draw(t){const i=a.getAsset("./assets/objects/RiceCooker_Off.png"),n=a.getAsset("./assets/objects/RiceCooker_On.png");t.drawImage(i,this.x,this.y,this.w,this.h),this.clicked&&(t.drawImage(n,this.x,this.y,this.w,this.h),t.strokeStyle="red",t.lineWidth=3,t.strokeRect(this.x,this.y,this.w,this.h))}};class nt extends y{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}initalizeScene(){this.addGameObject(new ot(this.game,0,0));let t=new R(this.game,10),i=new it(this.game);this.addGameObject(i),this.addGameObject(t)}}let ot=class extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=i,this.y=n,this.spritesheet=a.getAsset("./assets/backgrounds/Minigame_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};class at extends c{constructor(t){super(t);e(this,"game");e(this,"liters");e(this,"spritesheet");e(this,"width");e(this,"height");e(this,"x");e(this,"y");this.game=t,this.liters=0,this.spritesheet=a.getAsset("./assets/objects/Pot_Animation.png"),this.width=380,this.height=300,this.x=322,this.y=386}update(){}draw(t){this.liters==0?t.drawImage(this.spritesheet,0,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=100?t.drawImage(this.spritesheet,380,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=200?t.drawImage(this.spritesheet,760,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=300?t.drawImage(this.spritesheet,1140,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=400?t.drawImage(this.spritesheet,1520,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=500?t.drawImage(this.spritesheet,1900,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=600?t.drawImage(this.spritesheet,2280,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=700?t.drawImage(this.spritesheet,2660,0,this.width,this.height,this.x,this.y,this.width,this.height):this.liters<=800?t.drawImage(this.spritesheet,3040,0,this.width,this.height,this.x,this.y,this.width,this.height):t.drawImage(this.spritesheet,3420,0,this.width,this.height,this.x,this.y,this.width,this.height)}}class ht extends y{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}initalizeScene(){this.addGameObject(new rt(this.game,0,0));const t=new at(this.game);this.addGameObject(t),this.addGameObject(new P(this.game,t))}}let rt=class extends c{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");e(this,"spritesheet");this.game=t,this.x=i,this.y=n,this.spritesheet=a.getAsset("./assets/backgrounds/FillThePot_Background.png")}update(){}draw(t){t.drawImage(this.spritesheet,0,0)}};class B extends c{constructor(t,i,n=0,o=0,r=0,d=0){super(t,"background");e(this,"game");e(this,"spritesheet");e(this,"x");e(this,"y");e(this,"width");e(this,"height");this.game=t,this.spritesheet=a.getAsset(i),this.x=n,this.y=o,r==0&&d==0?(this.width=this.spritesheet.width,this.height=this.spritesheet.height):(this.width=r,this.height=d)}update(){}draw(t){t.drawImage(this.spritesheet,this.x,this.y,this.width,this.height)}}class dt{constructor(s,t){e(this,"ingredients");e(this,"sides");this.ingredients=s,this.sides=t}}class u{constructor(s,t){e(this,"type");e(this,"img");this.type=s,this.img=t}}class G extends u{constructor(t,i){super(t,i);e(this,"type");e(this,"img");this.type=t,this.img=i}}class S{constructor(s){e(this,"type");this.type=s}}const x=[new G("rice","./assets/objects/Rice_Cooked.png"),new G("nori","./assets/objects/Nori.png")],ct=[new u("crab","./assets/assembly/crab.png"),new u("avocado","./assets/assembly/avocado.png"),new u("cucmber","./assets/assembly/cucumber.png"),new u("salmon","./assets/assembly/salmon.png"),new u("tamago","./assets/assembly/tamago.png"),new u("tuna","./assets/assembly/tuna.png"),new u("uni","./assets/assembly/uni.png")],C=[new S("wasabi"),new S("ginger")],lt=[new S("miso soup"),new S("karaage"),new S("edamame"),new S("takoyaki")];class gt extends c{constructor(t,i,n){super(t,"customer",!0);e(this,"game");e(this,"x");e(this,"y");e(this,"yDrawOffset");e(this,"spritesheet");e(this,"exclamationSprite");e(this,"width");e(this,"height");e(this,"state");e(this,"order");e(this,"okButton");this.game=t,this.x=i,this.y=n,this.yDrawOffset=0,this.spritesheet=a.getAsset("./assets/characters/dummy.png"),this.exclamationSprite=a.getAsset("./assets/button/exclam.png"),this.width=400,this.height=600,this.state="init",this.order=null,this.addButton()}update(){switch(this.state){case"init":this.state="walking";let t=this;async function i(){await t.walkTo(100,100),t.state="waiting"}i();break}}draw(t){switch(t.drawImage(this.spritesheet,this.x,this.y+this.yDrawOffset,this.width,this.height),this.state){case"init":break;case"walking":break;case"waiting":t.drawImage(this.exclamationSprite,this.x+this.spritesheet.width/2-this.exclamationSprite.width/2-10,this.y-30,100,100);break;case"order":this.drawOrder(t);break}}drawOrder(t){if(!this.order)return;const i=500,n=100,o=(x.length+3+C.length+1)*40;t.fillStyle="white",t.fillRect(i,n,200,o),t.fillStyle="black",t.strokeRect(i,n,200,o),t.font="20px Arial",t.textAlign="center";let r=n;this.order.ingredients.forEach(d=>{if(d.type==="rice"||d.type==="nori")t.fillText(d.type,600,n+r);else{const l=a.getAsset(d.img);t.drawImage(l,600-l.width/2,n+r),r+=l.height}r+=30}),this.order.sides.forEach(d=>{t.fillText(d.type,600,100+r),r+=30}),this.okButton.hidden=!1}async walkTo(t,i){let n=this;return new Promise(o=>{let r=0;function d(){const g=Math.abs(n.x-t),D=Math.abs(n.y-i),f=t-n.x,p=i-n.y,E=Math.sqrt(f*f+p*p),q=f/E,_=p/E,H=Math.min(q*5,g),W=Math.min(_*5,D);if(n.x!==t&&(n.x+=H),n.x!==t&&(n.y+=W),n.x===t&&n.y===i){o(!0);return}n.yDrawOffset=Math.sin(Math.PI/4*r)*10,requestAnimationFrame(d),r+=.1}d()})}displayOrder(){this.order=this.randomOrder()}addButton(){this.okButton=m.rectButton(this.game,750,400,100,50,()=>{this.orderAdded=!0,this.okButton.hidden=!0,I.addOrder(this.order)},"OK"),this.okButton.persistent=!0,this.okButton.hidden=!0,this.game.currentScene&&this.game.currentScene.addGameObject(this.okButton)}randomOrder(){function t(f,p){return f.slice().sort(()=>.5-Math.random()).slice(0,p)}const i=M(2,x.length),n=M(1,3),o=M(0,C.length),r=M(0,1),d=t(x,i),l=t(ct,n),g=t(C,o),D=t(lt,r);return new dt([...d,...l],[...g,...D])}onMouseDown(t){this.state==="waiting"&&t.x>this.x&&t.x<this.x+this.width&&t.y>this.y&&t.y<this.y+this.height&&(this.displayOrder(),this.state="order")}}class ut extends y{constructor(t,i,n){super(t);e(this,"game");e(this,"x");e(this,"y");this.game=t,this.x=i,this.y=n}initalizeScene(){this.addGameObject(new B(this.game,"./assets/backgrounds/Order_Background.png")),this.addPersistantGameObject("customer")||(console.log("Did not find customer"),this.addGameObject(new gt(this.game,500,25))),this.addGameObject(new B(this.game,"./assets/backgrounds/Order_Foreground.png"))}}class mt extends y{constructor(t){super(t);e(this,"game");this.game=t}initalizeScene(){super.addGameObject(new B(this.game,"./assets/backgrounds/Station_Background.png")),super.addGameObject(new wt(this.game,450,375));const t=new ft(this.game,10,10,512,512);super.addGameObject(t);const i=new pt(this.game,500,80,450,300);super.addGameObject(i)}}class ft extends c{constructor(t,i,n,o,r){super(t,"riceCooker");e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"amount");e(this,"cookerClicked");e(this,"spritesheet");e(this,"dnd");this.game=t,this.x=i,this.y=n,this.width=o,this.height=r,this.amount=0,this.cookerClicked=!1,this.spritesheet=a.getAsset("./assets/objects/RiceCooker.png"),this.addButton(),super.loadSharedData()}addButton(){this.dnd=b.transparentImageButton(this.game,this.x,this.y,this.width,this.height,x[0].img,()=>{console.log("clicked on rice cooker"),this.cookerClicked=!0}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=x[0],this.dnd.persistent=!0,this.dnd.id="ricesourcebuttons",this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){this.cookerClicked&&(this.amount==0&&(this.beginMinigame(),this.amount=5),this.amount--,this.cookerClicked=!1)}draw(t){t.drawImage(this.spritesheet,this.x,this.y)}beginMinigame(){const t=Math.floor(Math.random()*3);console.log(t),t==0?(O.loadScene("fill"),console.log("minigame 1")):t==1?(O.loadScene("burn"),console.log("minigame 2")):t==2&&(O.loadScene("wash"),console.log("minigame 3"))}}class pt extends c{constructor(t,i,n,o,r){super(t,"norisource");e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"spritesheet");e(this,"dnd");this.game=t,this.x=i,this.y=n,this.width=o,this.height=r,this.spritesheet=a.getAsset("./assets/objects/Nori_Source.png"),this.addButton()}addButton(){this.dnd=b.transparentImageButton(this.game,this.x,this.y,this.width,this.height,x[1].img,()=>{}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=x[1],this.dnd.persistent=!0,this.dnd.id="norisourcebutton",this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){}draw(t){t.drawImage(this.spritesheet,this.x,this.y)}}class wt extends c{constructor(t,i,n){super(t,"bamboomat");e(this,"game");e(this,"x");e(this,"y");e(this,"ingredients");e(this,"spritesheet");this.x=i,this.y=n,this.ingredients=[],this.spritesheet=a.getAsset("./assets/objects/BambooMat.png")}update(){}draw(t){t.drawImage(this.spritesheet,this.x,this.y),this.x+this.spritesheet.width/2,this.y+this.spritesheet.height/2,this.ingredients.forEach(i=>{const n=a.getAsset(i.img);t.drawImage(n,this.x,this.y)})}onDnDDrop(t){t.detail.x>=this.x&&t.detail.x<=this.x+512&&t.detail.y>=this.y&&t.detail.y<=this.y+512&&(console.log("dropped in food bottom"),this.ingredients.push(t.detail.button.food),w.addIngredient(new u(t.detail.button.food.type,t.detail.button.food.img)))}}class yt extends y{constructor(t){super(t);e(this,"game");e(this,"foodBottom");e(this,"rollButton");this.game=t}initalizeScene(){super.addGameObject(new B(this.game,"./assets/backgrounds/Station_Background.png")),super.addGameObject(new B(this.game,"./assets/assembly/case.jpg",0,150,1024,197)),this.foodBottom=new xt(this.game,227,375,570,300),super.addGameObject(this.foodBottom);const t=80,i=80,n=[{name:"rice",img:"./assets/assembly/crab.png"},{name:"avocado",img:"./assets/assembly/avocado.png"},{name:"crab",img:"./assets/assembly/crab.png"},{name:"cucumber",img:"./assets/assembly/cucumber.png"},{name:"salmon",img:"./assets/assembly/salmon.png"},{name:"tuna",img:"./assets/assembly/tuna.png"},{name:"shrimp",img:"./assets/assembly/cucumber.png"},{name:"eel",img:"./assets/assembly/cucumber.png"},{name:"uni",img:"./assets/assembly/uni.png"},{name:"tamago",img:"./assets/assembly/tamago.png"},{name:"idk",img:"./assets/assembly/cucumber.png"},{name:"idk",img:"./assets/assembly/cucumber.png"}];let o=0,r=240;for(let d=0;d<12;d++){const l=new bt(this.game,n[o],10+d*(t+4),r,t,i);super.addGameObject(l),l.addButton(),o++}this.rollButton=m.rectButton(this.game,600,320,100,50,()=>{console.log("Clicked roll button"),this.roll(),w.completeRoll()},"Roll"),this.rollButton.hidden=!0,super.addGameObject(this.rollButton),super.addGameObject(new kt(this.game,this))}roll(){console.log("rolling"),this.rollButton.removeFromWorld=!0,this.foodBottom.rolled=!0}}class bt extends c{constructor(t,i,n,o,r,d){super(t,"foodbin");e(this,"game");e(this,"food");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"dnd");this.game=t,this.food=i,this.x=n,this.y=o,this.width=r,this.height=d}addButton(){this.dnd=b.transparentImageButton(this.game,this.x,this.y,this.width,this.height,this.food.img,()=>{console.log("clicked on food bin",this.food)}),this.dnd.width=this.width,this.dnd.height=this.height,this.dnd.food=this.food,this.game.currentScene&&this.game.currentScene.addGameObject(this.dnd)}update(){}draw(t){t.drawImage(a.getAsset("./assets/assembly/tray.jpg"),this.x,this.y,this.width,this.height);const i=80,n=35,o=this.width-i,r=this.height-n,d=3,l=i/d,g=3,D=n/g;for(let f=0;f<g;f++)for(let p=0;p<d;p++)t.drawImage(a.getAsset(this.food.img),this.x+o+l*p,this.y+r/2-5+D*f)}}const T=75;class xt extends c{constructor(t,i,n,o,r){super(t,"foodbottom");e(this,"game");e(this,"x");e(this,"y");e(this,"width");e(this,"height");e(this,"foods");e(this,"rolled");e(this,"chops");e(this,"cut");this.game=t,this.x=i,this.y=n,this.width=o,this.height=r,this.foods=[],this.rolled=!1,this.chops=0,this.cut=!1}update(){this.rolled&&(this.chops>=15&&(this.cut=!0,console.log("Cut sushi")),this.game.down?(this.game.timer.gameTime-this.game.previousMousePositionsLatest>.1&&(this.game.previousMousePositions=[]),this.game.previousMousePositions.length===15&&this.game.previousMousePositions.forEach((t,i)=>{t.x>this.x-this.width/2&&t.x<this.x+this.width/2&&t.y>this.y&&t.y<this.y+T&&(this.chops+=1)})):this.game.previousMousePositions=[])}draw(t){if(w.activeIngredients.length>0){if(this.cut){t.fillStyle="green";const n=(this.width-50)/6;for(let o=0;o<6;o++)t.fillRect(this.x-5+(n+5)*o,this.y+100,n,T);if(this.game.sliding)return;setTimeout(()=>{setInterval(()=>{this.x+=10,this.x>1024&&(super.removeFromWorld=!0)},10)},1e3),this.game.sliding=!0;return}if(this.rolled){t.fillStyle="green",t.fillRect(this.x,this.y+100,this.width-50,T),this.game.down&&(t.beginPath(),this.game.previousMousePositions.forEach((n,o)=>{o===0?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y)}),t.stroke());return}const i=a.getAsset("./assets/objects/BambooMat.png");t.drawImage(i,this.x,this.y),w.activeIngredients.forEach(n=>{if(n.type=="rice"||n.type=="nori"){const o=a.getAsset(n.img);t.drawImage(o,this.x,this.y)}}),this.foods.forEach(n=>{const o=a.getAsset(n.img),r=50,d=(this.width-r-50)/6;for(let l=0;l<6;l++)t.drawImage(o,this.x+l*d+r,this.y+100,o.width*2,o.height*2)})}}onDnDDrop(t){t.detail.x>=this.x&&t.detail.x<=this.x+this.width&&t.detail.y>=this.y&&t.detail.y<=this.y+this.height&&w.activeIngredients.length>0&&(console.log("dropped in food bottom"),this.foods.push(t.detail.button.food),w.addIngredient(new u(t.detail.button.food.name)),t.detail.button.game.currentScene.rollButton.hidden=!1)}}class kt extends c{constructor(t,i){super(t);e(this,"game");e(this,"scene");e(this,"orderManageButtonExists");this.game=t,this.scene=i,this.orderManageButtonExists=!1}update(){this.orderManageButtonExists||(this.orderManageButtonExists=!0,I.orderButton.removeFromWorld=!1,this.scene.addGameObject(I.orderButton))}draw(t){}}class St{constructor(s){e(this,"game");e(this,"scenes");e(this,"currentScene");this.game=s,this.scenes={},this.currentScene=null,this.registerScene("order",new ut(this.game,0,0)),this.registerScene("rice",new mt(this.game)),this.registerScene("roll",new yt(this.game)),this.registerScene("sides",new A(this.game,0,0)),this.registerScene("burn",new nt(this.game,0,0)),this.registerScene("fill",new ht(this.game,0,0)),this.registerScene("wash",new A(this.game,0,0)),this.loadScene("order")}registerScene(s,t){this.scenes[s]=t}loadScene(s){this.currentScene!==s&&this.scenes[s]&&(this.currentScene&&this.scenes[this.currentScene].deload(),this.currentScene=s,this.game.currentScene=this.scenes[s],this.scenes[s].initalizeScene())}update(){}draw(s){}}class Ot{constructor(s){e(this,"game");e(this,"orderButton");e(this,"riceButton");e(this,"rollButton");e(this,"sidesButton");this.game=s,this.orderButton=m.imageButton(s,102,694,"./assets/button/Order_Button.JPG",()=>this.game.sceneManager.loadScene("order")),this.riceButton=m.imageButton(s,318,694,"./assets/button/Rice_Button.JPG",()=>this.game.sceneManager.loadScene("rice")),this.rollButton=m.imageButton(s,534,694,"./assets/button/Roll_Button.JPG",()=>this.game.sceneManager.loadScene("roll")),this.sidesButton=m.imageButton(s,750,694,"./assets/button/Side_Button.JPG",()=>this.game.sceneManager.loadScene("sides")),s.addEntity(this.orderButton),s.addEntity(this.riceButton),s.addEntity(this.rollButton),s.addEntity(this.sidesButton)}update(){}draw(s){}}class Dt{constructor(s){e(this,"game");e(this,"activeIngredients");e(this,"isComplete");this.game=s,this.activeIngredients=[],this.isComplete=!1}addIngredient(s){this.activeIngredients.push(s),console.log(s)}getRolls(){return this.activeIngredients}completeRoll(){this.isComplete=!0}update(){}draw(s){}}const a=new N;let O,I,w;a.queueDownload("./assets/backgrounds/Rice_Background.JPG");a.queueDownload("./assets/backgrounds/Roll_Background.JPG");a.queueDownload("./assets/backgrounds/Order_Background.png");a.queueDownload("./assets/backgrounds/Order_Foreground.png");a.queueDownload("./assets/backgrounds/Station_Background.png");a.queueDownload("./assets/backgrounds/Minigame_Background.png");a.queueDownload("./assets/objects/RiceCooker.png");a.queueDownload("./assets/objects/BambooMat.png");a.queueDownload("./assets/objects/Rice_Cooked.png");a.queueDownload("./assets/objects/Nori.png");a.queueDownload("./assets/objects/Nori_Source.png");a.queueDownload("./assets/button/Rice_Button.JPG");a.queueDownload("./assets/button/Roll_Button.JPG");a.queueDownload("./assets/button/Side_Button.JPG");a.queueDownload("./assets/button/Order_Button.JPG");a.queueDownload("./assets/assembly/case.jpg");a.queueDownload("./assets/assembly/tray.jpg");a.queueDownload("./assets/hand.png");a.queueDownload("./assets/pot_top.png");a.queueDownload("./assets/pot_top_outside.png");a.queueDownload("./assets/rotate.png");a.queueDownload("./assets/checkmark.png");a.queueDownload("./assets/objects/Faucet_Off.png");a.queueDownload("./assets/objects/Faucet_On.png");a.queueDownload("./assets/objects/Pot_Animation.png");a.queueDownload("./assets/backgrounds/FillThePot_Background.png");a.queueDownload("./assets/objects/RiceCooker_On.png");a.queueDownload("./assets/objects/RiceCooker_Off.png");a.queueDownload("./assets/sounds/jingle.mp3");a.queueDownload("./assets/flies.png");a.queueDownload("./assets/swatter.png");a.queueDownload("./assets/characters/dummy.png");a.queueDownload("./assets/button/exclam.png");a.queueDownload("./assets/assembly/crab.png");a.queueDownload("./assets/assembly/cucumber.png");a.queueDownload("./assets/assembly/tuna.png");a.queueDownload("./assets/assembly/avocado.png");a.queueDownload("./assets/assembly/salmon.png");a.queueDownload("./assets/assembly/uni.png");a.queueDownload("./assets/assembly/tamago.png");a.downloadAll(()=>{const h=new Y({debugging:!1}),s=document.getElementById("gameWorld");if(!s)throw new Error("Canvas element not found");const t=s.getContext("2d");if(!t)throw new Error("Canvas context not found");h.init(t),O=new St(h),h.addEntity(O),h.sceneManager=O,I=new J(h),w=new Dt(h),h.addEntity(I),h.addEntity(w),h.addEntity(new Ot(h)),h.start()});window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||((h,s)=>{window.setTimeout(h,1e3/60)});
//# sourceMappingURL=index-CGtjSWRE.js.map
